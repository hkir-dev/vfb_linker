file_name	section	paragraph	sentence_num	mention_text	candidate_entity_iri	candidate_entity_label	candidate_entity_aliases	confidence	sentence
PMC7790857	Title	1	1	convergence	FBbt:00051207	larval mushroom body-lateral horn convergence neuron	larval CN,FBbt:00051207,larval convergence neuron	0.9244601130485535	Neuronal diversity and convergence in a visual system developmental atlas
PMC7790857	Abstract	1	2	Drosophila	FBbt:00000001	organism	Drosophila,FBbt:00000001,whole organism	1.0	In contrast to mammalian brains1,2, the large neuronal diversity of the Drosophila optic lobes3 and its connectome4-6 are almost completely characterized.
PMC7790857	Abstract	1	4	brain	FBbt:00110636	adult cerebral ganglion	CRG,FBbt:00110636,SPG,adult supraesophageal ganglion,brain,cerebrum	1.0	We present novel insights into brain development through a nearly exhaustive description of the transcriptomic diversity of the optic lobes.
PMC7790857	Abstract	1	5	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We acquired the transcriptome of 275,000 single-cells at adult and five pupal stages, and developed a machine learning framework to assign them to almost 200 cell-types at all timepoints.
PMC7790857	Abstract	1	8	adults	FBbt:00003004	adult	imago,FBbt:00003004	0.8939151167869568	We also resolved during synaptogenesis neuronal subtypes that converge to indistinguishable transcriptomic profiles in adults while greatly differing in morphology and connectivity.
PMC7790857	Abstract	1	9	brain	FBbt:00110636	adult cerebral ganglion	CRG,FBbt:00110636,SPG,adult supraesophageal ganglion,brain,cerebrum	1.0	Our datasets almost completely account for the known neuronal diversity of the optic lobes and serve as a paradigm to understand brain development across species.
PMC7790857	[Introduction]	1	1	brain	FBbt:00110636	adult cerebral ganglion	CRG,FBbt:00110636,SPG,adult supraesophageal ganglion,brain,cerebrum	1.0	The optic lobes constitute two thirds of the fly brain with approximately 60,000 neurons per lobe and around 200 morphologically distinct neuronal types [3], [7-12].
PMC7790857	[Introduction]	1	2	photoreceptors	FBbt:00004211	photoreceptor neuron	photoreceptor cell,FBbt:00004211,receptor cell	0.9045262336730957	The visual information detected by the photoreceptors is integrated in its four neuropils: lamina, medulla, lobula and lobula plate (Fig.1a), which are each divided into ~750 columns, corresponding to the ~750 ommatidia in the compound eye.
PMC7790857	[Introduction]	1	2	lamina	FBbt:00003708	lamina	LA,FBbt:00003708,La	1.0	The visual information detected by the photoreceptors is integrated in its four neuropils: lamina, medulla, lobula and lobula plate (Fig.1a), which are each divided into ~750 columns, corresponding to the ~750 ommatidia in the compound eye.
PMC7790857	[Introduction]	1	2	medulla	FBbt:00003748	medulla	ME,FBbt:00003748,Med,m,optic medulla	1.0	The visual information detected by the photoreceptors is integrated in its four neuropils: lamina, medulla, lobula and lobula plate (Fig.1a), which are each divided into ~750 columns, corresponding to the ~750 ommatidia in the compound eye.
PMC7790857	[Introduction]	1	2	lobula	FBbt:00003852	lobula	LO,FBbt:00003852,Lo,Lob	1.0	The visual information detected by the photoreceptors is integrated in its four neuropils: lamina, medulla, lobula and lobula plate (Fig.1a), which are each divided into ~750 columns, corresponding to the ~750 ommatidia in the compound eye.
PMC7790857	[Introduction]	1	2	lobula plate	FBbt:00003885	lobula plate	LOP,FBbt:00003885,LoP,Lop,lobula plate neuropil	1.0	The visual information detected by the photoreceptors is integrated in its four neuropils: lamina, medulla, lobula and lobula plate (Fig.1a), which are each divided into ~750 columns, corresponding to the ~750 ommatidia in the compound eye.
PMC7790857	[Introduction]	1	2	eye	FBbt:00004508	eye	compound eye,FBbt:00004508	0.9999998807907104	The visual information detected by the photoreceptors is integrated in its four neuropils: lamina, medulla, lobula and lobula plate (Fig.1a), which are each divided into ~750 columns, corresponding to the ~750 ommatidia in the compound eye.
PMC7790857	[Introduction]	2	1	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	Most optic lobe neurons are produced continuously through larval and early pupal development from two crescent-shaped neuroepithelia called the Outer and Inner Proliferation Centers (OPC and IPC).
PMC7790857	[Introduction]	2	1	larval	FBbt:00005837	embryonic/larval neuromuscular junction	larval NMJ,FBbt:00005837,larval neuromuscular junction	0.9999999403953552	Most optic lobe neurons are produced continuously through larval and early pupal development from two crescent-shaped neuroepithelia called the Outer and Inner Proliferation Centers (OPC and IPC).
PMC7790857	[Introduction]	2	1	OPC	FBbt:00001933	larval outer optic anlage	OOA,FBbt:00001933,OPC,embryonic/larval outer optic anlage,opc,outer proliferation center	1.0	Most optic lobe neurons are produced continuously through larval and early pupal development from two crescent-shaped neuroepithelia called the Outer and Inner Proliferation Centers (OPC and IPC).
PMC7790857	[Introduction]	2	1	IPC	FBbt:00001951	larval inner optic anlage	IOA,FBbt:00001951,IPC,embryonic/larval inner optic anlage,inner proliferation center,ipc	1.0	Most optic lobe neurons are produced continuously through larval and early pupal development from two crescent-shaped neuroepithelia called the Outer and Inner Proliferation Centers (OPC and IPC).
PMC7790857	[Introduction]	2	2	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	Immediately after birth, neurons project their processes to build the columns and protolayers of all neuropils, which is completed by 30% of pupal development (P30) [14].
PMC7790857	[Introduction]	2	6	cell	FBbt:00004781	wing basal cell 1	C' cell,FBbt:00004781	1.0	Characterizing both the common and cell type-specific genetic programs implemented by neurons at different stages of their development is thus essential.
PMC7790857	Developmental atlases of the optic lobe	1	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	The single-cell transcriptomic atlases of the adult Drosophila optic lobe previously generated by us [18] and others [19], or bulk sequencing of isolated cell types [18], [20], did not fully account for its cellular diversity.
PMC7790857	Developmental atlases of the optic lobe	1	1	Drosophila	FBbt:00000001	organism	Drosophila,FBbt:00000001,whole organism	1.0	The single-cell transcriptomic atlases of the adult Drosophila optic lobe previously generated by us [18] and others [19], or bulk sequencing of isolated cell types [18], [20], did not fully account for its cellular diversity.
PMC7790857	Developmental atlases of the optic lobe	1	1	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	The single-cell transcriptomic atlases of the adult Drosophila optic lobe previously generated by us [18] and others [19], or bulk sequencing of isolated cell types [18], [20], did not fully account for its cellular diversity.
PMC7790857	Developmental atlases of the optic lobe	1	2	adult optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	1.0	To produce an exhaustive catalog of neurons in the adult optic lobe (Fig1a-b), we obtained 109,743 single-cell transcriptomes (Methods) using the Chromium system (10x Genomics).
PMC7790857	Developmental atlases of the optic lobe	2	1	glia	FBbt:00100497	adult glial cell	glia,FBbt:00100497	1.0	We identified 172 clusters as optic lobe neurons and 19 clusters as glia that were sharply separated within the hierarchical tree of the clusters (Extended Data Fig5a), and one cluster of low-quality transcriptomes (Extended Data Fig2, Suppl.
PMC7790857	Developmental atlases of the optic lobe	2	1	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	We identified 172 clusters as optic lobe neurons and 19 clusters as glia that were sharply separated within the hierarchical tree of the clusters (Extended Data Fig5a), and one cluster of low-quality transcriptomes (Extended Data Fig2, Suppl.
PMC7790857	Developmental atlases of the optic lobe	2	3	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	We annotated neuronal clusters by calculating the Pearson correlations between the average gene expression of each cluster and 52 published bulk-transcriptomes obtained from purified optic lobe neuronal types [18], [20] and 2 additional (Pm2 and T4) sequenced for this study (Methods).
PMC7790857	Developmental atlases of the optic lobe	2	3	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	We annotated neuronal clusters by calculating the Pearson correlations between the average gene expression of each cluster and 52 published bulk-transcriptomes obtained from purified optic lobe neuronal types [18], [20] and 2 additional (Pm2 and T4) sequenced for this study (Methods).
PMC7790857	Developmental atlases of the optic lobe	2	3	Pm2	FBbt:00003835	proximal medullary amacrine neuron Pm2	Pm2,FBbt:00003835	1.0	We annotated neuronal clusters by calculating the Pearson correlations between the average gene expression of each cluster and 52 published bulk-transcriptomes obtained from purified optic lobe neuronal types [18], [20] and 2 additional (Pm2 and T4) sequenced for this study (Methods).
PMC7790857	Developmental atlases of the optic lobe	2	3	T4	FBbt:00003731	T neuron T4	T4,FBbt:00003731	1.0	We annotated neuronal clusters by calculating the Pearson correlations between the average gene expression of each cluster and 52 published bulk-transcriptomes obtained from purified optic lobe neuronal types [18], [20] and 2 additional (Pm2 and T4) sequenced for this study (Methods).
PMC7790857	Developmental atlases of the optic lobe	2	4	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	A clear match between a cell-type and a cluster should result in an obvious correlation gap between the best and second-best matches (Fig1c).
PMC7790857	Developmental atlases of the optic lobe	2	6	LC12	FBbt:00100484	lobula columnar neuron LC12	LC12,FBbt:00100484,Lcn12	0.9999998807907104	In addition, we identified the clusters corresponding to LC12, LC14, LC17, Pm1, T2a, TmY4, TmY8 and TmY14 neurons using the binarized expression (Methods) of combinations of protein markers identified by antibody or reporter line stainings (Extended Data Fig4, Suppl.
PMC7790857	Developmental atlases of the optic lobe	2	6	LC14	FBbt:00100486	lobula columnar neuron LC14	DC neuron,FBbt:00100486,LC14,Lcn14	1.0	In addition, we identified the clusters corresponding to LC12, LC14, LC17, Pm1, T2a, TmY4, TmY8 and TmY14 neurons using the binarized expression (Methods) of combinations of protein markers identified by antibody or reporter line stainings (Extended Data Fig4, Suppl.
PMC7790857	Developmental atlases of the optic lobe	2	6	LC17	FBbt:00111752	lobula columnar neuron LC17	LC17,FBbt:00111752	1.0	In addition, we identified the clusters corresponding to LC12, LC14, LC17, Pm1, T2a, TmY4, TmY8 and TmY14 neurons using the binarized expression (Methods) of combinations of protein markers identified by antibody or reporter line stainings (Extended Data Fig4, Suppl.
PMC7790857	Developmental atlases of the optic lobe	2	6	Pm1	FBbt:00003833	proximal medullary amacrine neuron Pm1	Pm1,FBbt:00003833	0.9999999403953552	In addition, we identified the clusters corresponding to LC12, LC14, LC17, Pm1, T2a, TmY4, TmY8 and TmY14 neurons using the binarized expression (Methods) of combinations of protein markers identified by antibody or reporter line stainings (Extended Data Fig4, Suppl.
PMC7790857	Developmental atlases of the optic lobe	2	6	T2a	FBbt:00003729	T neuron T2a	T2a,FBbt:00003729	0.9999999403953552	In addition, we identified the clusters corresponding to LC12, LC14, LC17, Pm1, T2a, TmY4, TmY8 and TmY14 neurons using the binarized expression (Methods) of combinations of protein markers identified by antibody or reporter line stainings (Extended Data Fig4, Suppl.
PMC7790857	Developmental atlases of the optic lobe	2	6	TmY4	FBbt:00003817	transmedullary Y neuron	TmY,FBbt:00003817	1.0	In addition, we identified the clusters corresponding to LC12, LC14, LC17, Pm1, T2a, TmY4, TmY8 and TmY14 neurons using the binarized expression (Methods) of combinations of protein markers identified by antibody or reporter line stainings (Extended Data Fig4, Suppl.
PMC7790857	Developmental atlases of the optic lobe	2	6	TmY8	FBbt:00003817	transmedullary Y neuron	TmY,FBbt:00003817	1.0	In addition, we identified the clusters corresponding to LC12, LC14, LC17, Pm1, T2a, TmY4, TmY8 and TmY14 neurons using the binarized expression (Methods) of combinations of protein markers identified by antibody or reporter line stainings (Extended Data Fig4, Suppl.
PMC7790857	Developmental atlases of the optic lobe	2	6	TmY14	FBbt:00111286	transmedullary Y neuron TmY14	TmY14,FBbt:00111286	0.9999998807907104	In addition, we identified the clusters corresponding to LC12, LC14, LC17, Pm1, T2a, TmY4, TmY8 and TmY14 neurons using the binarized expression (Methods) of combinations of protein markers identified by antibody or reporter line stainings (Extended Data Fig4, Suppl.
PMC7790857	Developmental atlases of the optic lobe	2	10	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	The very high resolution of this atlas is highlighted by the fact that we found distinct cluster matches even for rare neuronal types, such as Dm4 and Dm1 that are represented by only ~40 cells in each optic lobe [7].
PMC7790857	Developmental atlases of the optic lobe	2	10	Dm4	FBbt:00003771	distal medullary amacrine neuron Dm4	Dm4,FBbt:00003771	1.0	The very high resolution of this atlas is highlighted by the fact that we found distinct cluster matches even for rare neuronal types, such as Dm4 and Dm1 that are represented by only ~40 cells in each optic lobe [7].
PMC7790857	Developmental atlases of the optic lobe	2	10	Dm1	FBbt:00000498	muscle cell of dorsal mouthpart muscle 1	DM1,FBbt:00000498	1.0	The very high resolution of this atlas is highlighted by the fact that we found distinct cluster matches even for rare neuronal types, such as Dm4 and Dm1 that are represented by only ~40 cells in each optic lobe [7].
PMC7790857	Developmental atlases of the optic lobe	2	10	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	The very high resolution of this atlas is highlighted by the fact that we found distinct cluster matches even for rare neuronal types, such as Dm4 and Dm1 that are represented by only ~40 cells in each optic lobe [7].
PMC7790857	Developmental atlases of the optic lobe	2	11	neuron	FBbt:00001564	U neuron	U motor neuron,FBbt:00001564,U/CQ neuron	1.0	Thus, our dataset is likely to contain independent clusters for almost all neuron types present at more than 30 cells per optic lobe.
PMC7790857	Developmental atlases of the optic lobe	2	11	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	Thus, our dataset is likely to contain independent clusters for almost all neuron types present at more than 30 cells per optic lobe.
PMC7790857	Developmental atlases of the optic lobe	3	3	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We first trained a two-layer neural network (NN) on our labeled adult dataset to classify P70 cells into corresponding adult clusters (Methods).
PMC7790857	Developmental atlases of the optic lobe	3	4	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	This allowed us to sequence a lower number of cells at each pupal stage while retaining the high resolution of the adult dataset.
PMC7790857	Developmental atlases of the optic lobe	4	1	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	We then classified the earlier pupal datasets sequentially backwards throughout development (i.e. from P70 to P50, P50 to P40…).
PMC7790857	Developmental atlases of the optic lobe	4	2	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	We used a multi-task extension of our NN (Fig1f) in order to prevent over-fitting the classifiers, due to the smaller sample sizes of the pupal datasets (Methods).
PMC7790857	Developmental atlases of the optic lobe	4	4	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Interestingly, several adult clusters corresponded to two or more unsupervised clusters at earlier timepoints (Suppl.
PMC7790857	Developmental atlases of the optic lobe	4	6	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Using this iterative “classify-adjust-retrain” approach, we successfully assigned correspondences between pupal cells and each of our adult clusters (Extended Data Fig7).
PMC7790857	Developmental atlases of the optic lobe	4	8	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	As a benchmark, we tested our classifier on an atlas of the entire adult brain [19].
PMC7790857	Developmental atlases of the optic lobe	4	8	brain	FBbt:00110636	adult cerebral ganglion	CRG,FBbt:00110636,SPG,adult supraesophageal ganglion,brain,cerebrum	1.0	As a benchmark, we tested our classifier on an atlas of the entire adult brain [19].
PMC7790857	Developmental atlases of the optic lobe	5	2	Drosophila	FBbt:00000001	organism	Drosophila,FBbt:00000001,whole organism	1.0	Coupled with the detailed knowledge of optic lobe connectivity through EM reconstruction [4-6] and the Drosophila genetic toolkit, this represents a unique resource to investigate general mechanisms underlying the function and development of neuronal circuits.
PMC7790857	Discovery of Transient Extrinsic neurons	1	1	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	We identified two large neuronal clusters in the pupal datasets that received very low confidence scores from the NN classifier (indicating they may not exist in the adult dataset).
PMC7790857	Discovery of Transient Extrinsic neurons	1	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We identified two large neuronal clusters in the pupal datasets that received very low confidence scores from the NN classifier (indicating they may not exist in the adult dataset).
PMC7790857	Discovery of Transient Extrinsic neurons	1	5	lamina	FBbt:00003708	lamina	LA,FBbt:00003708,La	1.0	Their projections wrapped the dorsal and ventral edges of all optic lobe neuropils, except the lamina: each neuron possessed multiple branches that contacted (but did not enter) the neuropils at different points (Extended Data Fig8g-h).
PMC7790857	Discovery of Transient Extrinsic neurons	1	5	neuron	FBbt:00001564	U neuron	U motor neuron,FBbt:00001564,U/CQ neuron	1.0	Their projections wrapped the dorsal and ventral edges of all optic lobe neuropils, except the lamina: each neuron possessed multiple branches that contacted (but did not enter) the neuropils at different points (Extended Data Fig8g-h).
PMC7790857	Discovery of Transient Extrinsic neurons	1	6	adults	FBbt:00003004	adult	imago,FBbt:00003004	0.8939151167869568	These neurons could not be found in adults and cleaved Dcp1 staining, a readout of Caspase-3 activity, confirmed that they were gradually cleared through apoptosis during late pupal stages (Fig2b).
PMC7790857	Discovery of Transient Extrinsic neurons	1	7	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Activation of a FLEXAMP memory cassette [24] at L3 stage using R10D10-Gal4 (Extended Data Fig8e) confirmed that our failure to observe these neurons in adult brains was not due to downregulation of reporter expression.
PMC7790857	Discovery of Transient Extrinsic neurons	1	8	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Furthermore, expression of the anti-apoptotic protein p35 [25] caused the perdurance of these neurons in adult brains (Fig2b).
PMC7790857	Discovery of Transient Extrinsic neurons	2	1	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Analysis of the genes differentially expressed between the two TE clusters revealed that only one of the clusters expressed Wnt4 while the other expressed Wnt10 (Fig5c).
PMC7790857	Discovery of Transient Extrinsic neurons	2	1	Wnt4	FBbt:00003160	adult heart chamber 4	Ht4,FBbt:00003160,chamber 4,terminal cardiac chamber	1.0	Analysis of the genes differentially expressed between the two TE clusters revealed that only one of the clusters expressed Wnt4 while the other expressed Wnt10 (Fig5c).
PMC7790857	Discovery of Transient Extrinsic neurons	2	2	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Indeed, Wnt4-Gal4 was only expressed in the ventral cluster of TE neurons (Fig2e) that we named TEv, while the Wnt10^+ cluster was named TEd.
PMC7790857	Discovery of Transient Extrinsic neurons	2	2	TEv	FBbt:00058014	ventral transient extrinsic neuron of pupal optic lobe	TEv,FBbt:00058014,TEv neuron	1.0	Indeed, Wnt4-Gal4 was only expressed in the ventral cluster of TE neurons (Fig2e) that we named TEv, while the Wnt10^+ cluster was named TEd.
PMC7790857	Discovery of Transient Extrinsic neurons	2	2	TEd	FBbt:00058015	dorsal transient extrinsic neuron of pupal optic lobe	TEd,FBbt:00058015,TEd neuron	1.0	Indeed, Wnt4-Gal4 was only expressed in the ventral cluster of TE neurons (Fig2e) that we named TEv, while the Wnt10^+ cluster was named TEd.
PMC7790857	Discovery of Transient Extrinsic neurons	2	3	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Although we never observed TE neurons contacting the lamina, Fs-Gal4 was also expressed at P30 in photoreceptors from one row of ommatidia at the edge of the retina that connect to the edges of the lamina (Fig2d) and are also apoptotically removed during development [26].
PMC7790857	Discovery of Transient Extrinsic neurons	2	3	lamina	FBbt:00003708	lamina	LA,FBbt:00003708,La	1.0	Although we never observed TE neurons contacting the lamina, Fs-Gal4 was also expressed at P30 in photoreceptors from one row of ommatidia at the edge of the retina that connect to the edges of the lamina (Fig2d) and are also apoptotically removed during development [26].
PMC7790857	Discovery of Transient Extrinsic neurons	2	3	photoreceptors	FBbt:00004211	photoreceptor neuron	photoreceptor cell,FBbt:00004211,receptor cell	0.9045262336730957	Although we never observed TE neurons contacting the lamina, Fs-Gal4 was also expressed at P30 in photoreceptors from one row of ommatidia at the edge of the retina that connect to the edges of the lamina (Fig2d) and are also apoptotically removed during development [26].
PMC7790857	Discovery of Transient Extrinsic neurons	3	1	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	A third TE cluster, which we called TEe (early), could only be found at P15 and P30.
PMC7790857	Discovery of Transient Extrinsic neurons	3	1	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	A third TE cluster, which we called TEe (early), could only be found at P15 and P30.
PMC7790857	Discovery of Transient Extrinsic neurons	3	1	TEe	FBbt:00058014	ventral transient extrinsic neuron of pupal optic lobe	TEv,FBbt:00058014,TEv neuron	1.0	A third TE cluster, which we called TEe (early), could only be found at P15 and P30.
PMC7790857	Discovery of Transient Extrinsic neurons	3	2	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	This cluster was connected to both TE clusters on UMAP visualization (Fig2a) and was bsh^+/hth^-.
PMC7790857	Discovery of Transient Extrinsic neurons	3	2	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	This cluster was connected to both TE clusters on UMAP visualization (Fig2a) and was bsh^+/hth^-.
PMC7790857	Discovery of Transient Extrinsic neurons	3	3	OPC	FBbt:00001933	larval outer optic anlage	OOA,FBbt:00001933,OPC,embryonic/larval outer optic anlage,opc,outer proliferation center	1.0	In L3 optic lobes, we could observe a few Bsh^+/Hth^- cells labeled by R10D10-Gal4 at the tips of the OPC (Extended Data Fig8f), suggesting that TE cells are produced there (the only other Bsh^+ neurons are Hth^+ Mi1 [29]).
PMC7790857	Discovery of Transient Extrinsic neurons	3	3	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	In L3 optic lobes, we could observe a few Bsh^+/Hth^- cells labeled by R10D10-Gal4 at the tips of the OPC (Extended Data Fig8f), suggesting that TE cells are produced there (the only other Bsh^+ neurons are Hth^+ Mi1 [29]).
PMC7790857	Discovery of Transient Extrinsic neurons	3	3	Hth^+ Mi1	FBbt:00003776	medullary intrinsic neuron Mi1	Mi1,FBbt:00003776,Sut,medullary intrinsic neuron 1,small field unilateral tristratified neuron	0.9999998807907104	In L3 optic lobes, we could observe a few Bsh^+/Hth^- cells labeled by R10D10-Gal4 at the tips of the OPC (Extended Data Fig8f), suggesting that TE cells are produced there (the only other Bsh^+ neurons are Hth^+ Mi1 [29]).
PMC7790857	Discovery of Transient Extrinsic neurons	3	4	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Bsh was also expressed in a subset of TE neurons at P30 (Extended Data Fig8g).
PMC7790857	Discovery of Transient Extrinsic neurons	3	5	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	FLEXAMP memory cassette driven by bsh-Gal4 labeled all TE neurons (Extended Data Fig8i), confirming that TEe cluster contains younger bsh^+ TE neurons that lose bsh expression as they mature.
PMC7790857	Discovery of Transient Extrinsic neurons	3	5	TEe	FBbt:00058014	ventral transient extrinsic neuron of pupal optic lobe	TEv,FBbt:00058014,TEv neuron	1.0	FLEXAMP memory cassette driven by bsh-Gal4 labeled all TE neurons (Extended Data Fig8i), confirming that TEe cluster contains younger bsh^+ TE neurons that lose bsh expression as they mature.
PMC7790857	Discovery of Transient Extrinsic neurons	3	5	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	FLEXAMP memory cassette driven by bsh-Gal4 labeled all TE neurons (Extended Data Fig8i), confirming that TEe cluster contains younger bsh^+ TE neurons that lose bsh expression as they mature.
PMC7790857	Discovery of Transient Extrinsic neurons	3	6	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	TE neurons expressing bsh were present in decreasing numbers until P50, but not at P70.
PMC7790857	Discovery of Transient Extrinsic neurons	3	7	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	We therefore propose that TE neurons are produced continuously from a relatively small number of progenitors at the OPC tips.
PMC7790857	Discovery of Transient Extrinsic neurons	3	7	OPC	FBbt:00001933	larval outer optic anlage	OOA,FBbt:00001933,OPC,embryonic/larval outer optic anlage,opc,outer proliferation center	1.0	We therefore propose that TE neurons are produced continuously from a relatively small number of progenitors at the OPC tips.
PMC7790857	Discovery of Transient Extrinsic neurons	4	1	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	The transient nature of TE neurons, their superficial innervations and enrichment in secretory markers are reminiscent of mammalian Cajal-Retzius cells [30] that are essential for neuronal migration and other developmental processes.
PMC7790857	Discovery of Transient Extrinsic neurons	4	2	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Further investigations will determine whether TE cells serve comparable functions in fly brain development (Supplementary Discussion).
PMC7790857	Discovery of Transient Extrinsic neurons	4	2	brain	FBbt:00110636	adult cerebral ganglion	CRG,FBbt:00110636,SPG,adult supraesophageal ganglion,brain,cerebrum	1.0	Further investigations will determine whether TE cells serve comparable functions in fly brain development (Supplementary Discussion).
PMC7790857	Synchronization of serially born neurons	1	1	IPC	FBbt:00001951	larval inner optic anlage	IOA,FBbt:00001951,IPC,embryonic/larval inner optic anlage,inner proliferation center,ipc	1.0	At larval stages, the IPC and medial OPC are progressively converted into neural stem cells (neuroblasts; NBs) that divide asymmetrically multiple times, each time self-renewing and producing a Ganglion Mother Cell (GMC), which in turn divides once to generate two neurons or glia [31].
PMC7790857	Synchronization of serially born neurons	1	1	OPC	FBbt:00001933	larval outer optic anlage	OOA,FBbt:00001933,OPC,embryonic/larval outer optic anlage,opc,outer proliferation center	1.0	At larval stages, the IPC and medial OPC are progressively converted into neural stem cells (neuroblasts; NBs) that divide asymmetrically multiple times, each time self-renewing and producing a Ganglion Mother Cell (GMC), which in turn divides once to generate two neurons or glia [31].
PMC7790857	Synchronization of serially born neurons	1	1	neuroblasts	FBbt:00005146	neuroblast	NB,FBbt:00005146,neural stem cell	0.9228275418281555	At larval stages, the IPC and medial OPC are progressively converted into neural stem cells (neuroblasts; NBs) that divide asymmetrically multiple times, each time self-renewing and producing a Ganglion Mother Cell (GMC), which in turn divides once to generate two neurons or glia [31].
PMC7790857	Synchronization of serially born neurons	1	1	Ganglion Mother Cell	FBbt:00005149	ganglion mother cell	GMC,FBbt:00005149	1.0	At larval stages, the IPC and medial OPC are progressively converted into neural stem cells (neuroblasts; NBs) that divide asymmetrically multiple times, each time self-renewing and producing a Ganglion Mother Cell (GMC), which in turn divides once to generate two neurons or glia [31].
PMC7790857	Synchronization of serially born neurons	1	1	GMC	FBbt:00005149	ganglion mother cell	GMC,FBbt:00005149	1.0	At larval stages, the IPC and medial OPC are progressively converted into neural stem cells (neuroblasts; NBs) that divide asymmetrically multiple times, each time self-renewing and producing a Ganglion Mother Cell (GMC), which in turn divides once to generate two neurons or glia [31].
PMC7790857	Synchronization of serially born neurons	1	1	glia	FBbt:00100497	adult glial cell	glia,FBbt:00100497	1.0	At larval stages, the IPC and medial OPC are progressively converted into neural stem cells (neuroblasts; NBs) that divide asymmetrically multiple times, each time self-renewing and producing a Ganglion Mother Cell (GMC), which in turn divides once to generate two neurons or glia [31].
PMC7790857	Synchronization of serially born neurons	1	2	photoreceptors	FBbt:00004211	photoreceptor neuron	photoreceptor cell,FBbt:00004211,receptor cell	0.9045262336730957	Similar to photoreceptors that are produced sequentially from the posterior to anterior of the eye imaginal disc, optic lobe neurons are also produced sequentially, with the first born neurons connecting to the most posterior photoreceptors while later born neurons connect to more anterior photoreceptors [32], [33],.
PMC7790857	Synchronization of serially born neurons	1	2	posterior	FBbt:00040046	posterior superior lateral protocerebrum	PSLP,FBbt:00040046,posterior SLP,posterior splr,pslpr	0.8775382041931152	Similar to photoreceptors that are produced sequentially from the posterior to anterior of the eye imaginal disc, optic lobe neurons are also produced sequentially, with the first born neurons connecting to the most posterior photoreceptors while later born neurons connect to more anterior photoreceptors [32], [33],.
PMC7790857	Synchronization of serially born neurons	1	3	lateral	FBbt:00004044	LN period neuron	LC,FBbt:00004044,LN,LN per neuron,adult lateral neuron,lateral cell,lateral neuron	0.8629997968673706	This is also true in the lateral OPC, where Lamina Precursor Cells (LPC) are progressively converted into lamina monopolar neurons [34].
PMC7790857	Synchronization of serially born neurons	1	3	OPC	FBbt:00001933	larval outer optic anlage	OOA,FBbt:00001933,OPC,embryonic/larval outer optic anlage,opc,outer proliferation center	1.0	This is also true in the lateral OPC, where Lamina Precursor Cells (LPC) are progressively converted into lamina monopolar neurons [34].
PMC7790857	Synchronization of serially born neurons	1	3	LPC	FBbt:00040047	clamp	CL,FBbt:00040047,LPC	1.0	This is also true in the lateral OPC, where Lamina Precursor Cells (LPC) are progressively converted into lamina monopolar neurons [34].
PMC7790857	Synchronization of serially born neurons	1	3	lamina monopolar	FBbt:00003718	lamina monopolar neuron	LMC,FBbt:00003718,lamina monopolar cell,monopolar laminar cell	0.978628933429718	This is also true in the lateral OPC, where Lamina Precursor Cells (LPC) are progressively converted into lamina monopolar neurons [34].
PMC7790857	Synchronization of serially born neurons	1	6	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Moreover, whereas we could assign all P30-P70 cells directly to adult clusters (Extended Data Fig7a-e) except for TE neurons and a few glia-like cells that were not investigated further (Methods), we found six clusters with low confidence scores from the NN at P15 (Extended Data Fig9a).
PMC7790857	Synchronization of serially born neurons	1	6	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Moreover, whereas we could assign all P30-P70 cells directly to adult clusters (Extended Data Fig7a-e) except for TE neurons and a few glia-like cells that were not investigated further (Methods), we found six clusters with low confidence scores from the NN at P15 (Extended Data Fig9a).
PMC7790857	Synchronization of serially born neurons	1	8	undifferentiated	FBbt:00049609	undifferentiated glial cell	developing glial cell,FBbt:00049609,udg	0.8597781658172607	Table 1) as NBs, GMCs (3 clusters), LPCs and undifferentiated apoptotic neurons (Fig3a).
PMC7790857	Synchronization of serially born neurons	1	9	GMC	FBbt:00005149	ganglion mother cell	GMC,FBbt:00005149	1.0	On UMAP visualization, most P15 neuronal clusters converged towards the GMC and NB clusters while lamina monopolar cells L1-L4 converged specifically towards the LPC cluster (Fig3a).
PMC7790857	Synchronization of serially born neurons	1	9	NB	FBbt:00005146	neuroblast	NB,FBbt:00005146,neural stem cell	1.0	On UMAP visualization, most P15 neuronal clusters converged towards the GMC and NB clusters while lamina monopolar cells L1-L4 converged specifically towards the LPC cluster (Fig3a).
PMC7790857	Synchronization of serially born neurons	1	9	lamina monopolar cells	FBbt:00003718	lamina monopolar neuron	LMC,FBbt:00003718,lamina monopolar cell,monopolar laminar cell	0.88212651014328	On UMAP visualization, most P15 neuronal clusters converged towards the GMC and NB clusters while lamina monopolar cells L1-L4 converged specifically towards the LPC cluster (Fig3a).
PMC7790857	Synchronization of serially born neurons	1	9	LPC	FBbt:00040047	clamp	CL,FBbt:00040047,LPC	1.0	On UMAP visualization, most P15 neuronal clusters converged towards the GMC and NB clusters while lamina monopolar cells L1-L4 converged specifically towards the LPC cluster (Fig3a).
PMC7790857	Synchronization of serially born neurons	1	9	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	On UMAP visualization, most P15 neuronal clusters converged towards the GMC and NB clusters while lamina monopolar cells L1-L4 converged specifically towards the LPC cluster (Fig3a).
PMC7790857	Synchronization of serially born neurons	2	2	T1	FBbt:00000017	prothoracic segment	prothorax,FBbt:00000017,t1,thoracic segment 1	1.0	To further investigate this phenomenon, we generated a UMAP plot containing only T1 and Tm3 neurons, combined from all stages with no batch correction (Extended Data Fig9d).
PMC7790857	Synchronization of serially born neurons	2	3	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	Due to continuous production of the neurons of the same type in the optic lobe, a Tm3/T1 cell born at P0 in the P30 dataset would be the same age as a Tm3/T1 cell born at P10 in the P40 dataset.
PMC7790857	Synchronization of serially born neurons	3	2	photoreceptors	FBbt:00004211	photoreceptor neuron	photoreceptor cell,FBbt:00004211,receptor cell	0.9045262336730957	This generalizes observations previously made in photoreceptors [39], [40] (Supplementary Discussion), and implies that all brain wiring steps beyond initial neuropil targeting (i.e. axon pathfinding, Fig1e) are executed synchronously in the optic lobe.
PMC7790857	Synchronization of serially born neurons	3	2	brain	FBbt:00110636	adult cerebral ganglion	CRG,FBbt:00110636,SPG,adult supraesophageal ganglion,brain,cerebrum	1.0	This generalizes observations previously made in photoreceptors [39], [40] (Supplementary Discussion), and implies that all brain wiring steps beyond initial neuropil targeting (i.e. axon pathfinding, Fig1e) are executed synchronously in the optic lobe.
PMC7790857	Synchronization of serially born neurons	3	2	neuropil	FBbt:00005139	neuropil	neuropil,FBbt:00005139	1.0	This generalizes observations previously made in photoreceptors [39], [40] (Supplementary Discussion), and implies that all brain wiring steps beyond initial neuropil targeting (i.e. axon pathfinding, Fig1e) are executed synchronously in the optic lobe.
PMC7790857	Synchronization of serially born neurons	3	2	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	This generalizes observations previously made in photoreceptors [39], [40] (Supplementary Discussion), and implies that all brain wiring steps beyond initial neuropil targeting (i.e. axon pathfinding, Fig1e) are executed synchronously in the optic lobe.
PMC7790857	Increased diversity at synaptogenesis	1	1	T4	FBbt:00003731	T neuron T4	T4,FBbt:00003731	1.0	Both T4 and T5 neurons have 4 subtypes (a/b/c/d) that each processes motion in one of four cardinal directions [41].
PMC7790857	Increased diversity at synaptogenesis	1	1	T5	FBbt:00003736	T neuron T5	T5,FBbt:00003736	1.0	Both T4 and T5 neurons have 4 subtypes (a/b/c/d) that each processes motion in one of four cardinal directions [41].
PMC7790857	Increased diversity at synaptogenesis	1	2	dendritic arbors	FBbt:00005111	dendritic tree	dendritic arbor,FBbt:00005111	0.9352812170982361	Their polarized dendritic arbors mirror their direction selectivity [6], [42].
PMC7790857	Increased diversity at synaptogenesis	1	5	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Many of the P50 subcluster markers turned off or lost their specificity in adult brains (Extended Data Fig10a), explaining why T4-5 subtypes were transcriptionally indistinguishable in adult brains (Fig1d).
PMC7790857	Increased diversity at synaptogenesis	2	1	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	In addition, Dm3 and Tm9 cells were split in two subgroups only at P50 and earlier stages (Extended Data Fig7).
PMC7790857	Increased diversity at synaptogenesis	2	1	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	In addition, Dm3 and Tm9 cells were split in two subgroups only at P50 and earlier stages (Extended Data Fig7).
PMC7790857	Increased diversity at synaptogenesis	2	2	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Subgroups of Tm9 have not been previously described (see last section), but Dm3 cells have two known sub-populations with orthogonal dendritic orientations [7].
PMC7790857	Increased diversity at synaptogenesis	2	3	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	Immunostainings against Bifid (Bi or Omb), which was differentially expressed between the Dm3 subclusters, showed that the dendrites of the Bi^+ Dm3b cells were always oriented posterior-dorsally while those of Bi^- Dm3a cells were oriented posterior-ventrally (n>100, Fig4b).
PMC7790857	Increased diversity at synaptogenesis	2	4	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	As Dm3 subtypes differentially expressed several cell surface molecules (CSM) during synapse formation, we asked whether they also differed in their connectivity.
PMC7790857	Increased diversity at synaptogenesis	2	5	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	Analysis of the medulla connectome [4] revealed that the two Dm3 subtypes connect differentially to several postsynaptic partners (Extended Data Fig10d, Methods).
PMC7790857	Increased diversity at synaptogenesis	2	6	Dm3-Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	0.9458171725273132	Most notably, Dm3-Dm3 synapses were found almost exclusively between the different subtypes.
PMC7790857	Increased diversity at synaptogenesis	3	1	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	Attempting to project Dm3 or Tm9 subdivisions onto adult clusters by training binary classifiers on the P50 cells (Methods) proved very unreliable with out-of-bag errors (OOBE, Methods) >20%.
PMC7790857	Increased diversity at synaptogenesis	3	1	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Attempting to project Dm3 or Tm9 subdivisions onto adult clusters by training binary classifiers on the P50 cells (Methods) proved very unreliable with out-of-bag errors (OOBE, Methods) >20%.
PMC7790857	Increased diversity at synaptogenesis	3	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Attempting to project Dm3 or Tm9 subdivisions onto adult clusters by training binary classifiers on the P50 cells (Methods) proved very unreliable with out-of-bag errors (OOBE, Methods) >20%.
PMC7790857	Increased diversity at synaptogenesis	3	3	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	Even though T4/T5, Dm3 and Tm9 may represent extreme cases, this increased transcriptional diversity during synapse formation is indeed a general phenomenon: Pearson correlations between the average gene expression profiles of clusters that are most similar to each other were significantly lower between P40-P70, across all neuronal clusters (Fig4c).
PMC7790857	Increased diversity at synaptogenesis	3	3	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Even though T4/T5, Dm3 and Tm9 may represent extreme cases, this increased transcriptional diversity during synapse formation is indeed a general phenomenon: Pearson correlations between the average gene expression profiles of clusters that are most similar to each other were significantly lower between P40-P70, across all neuronal clusters (Fig4c).
PMC7790857	Increased diversity at synaptogenesis	3	4	olfactory projection	FBbt:00007422	antennal lobe projection neuron	olfactory projection neuron,FBbt:00007422	0.9774688482284546	These results generalize the previous findings that olfactory projection neurons VA1d and DC3 are transcriptionally distinct during development but merge into a single cluster in adults [44].
PMC7790857	Increased diversity at synaptogenesis	3	4	VA1d	FBbt:00007101	antennal lobe glomerulus VA1d	VA1d,FBbt:00007101,antennal lobe glomerulus VA1 dorsal compartment	1.0	These results generalize the previous findings that olfactory projection neurons VA1d and DC3 are transcriptionally distinct during development but merge into a single cluster in adults [44].
PMC7790857	Increased diversity at synaptogenesis	3	4	adults	FBbt:00003004	adult	imago,FBbt:00003004	0.8939151167869568	These results generalize the previous findings that olfactory projection neurons VA1d and DC3 are transcriptionally distinct during development but merge into a single cluster in adults [44].
PMC7790857	Increased diversity at synaptogenesis	3	5	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	They also call into question the common practice of cell-type identification based solely on adult transcriptomes and advocate for developmentally based approaches.
PMC7790857	Increased diversity at synaptogenesis	4	2	receptor	FBbt:00004211	photoreceptor neuron	photoreceptor cell,FBbt:00004211,receptor cell	0.8798742890357971	This consistently revealed at all stages overwhelming enrichment for receptor binding/activity terms related to axon/dendrite development and synapse formation, followed by TF and ion channel terms (Extended Data Fig11a).
PMC7790857	Increased diversity at synaptogenesis	4	6	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	In contrast, early pupal markers were dominated by protein synthesis and adult markers by energy metabolism terms.
PMC7790857	Dorsoventral division of visual circuits	1	1	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Differential gene expression analysis between the two Tm9 subgroups at P50 indicated that one of them exclusively expressed Wnt4 while the other expressed Wnt10, similarly to TEv/d neurons.
PMC7790857	Dorsoventral division of visual circuits	1	1	Wnt4	FBbt:00003160	adult heart chamber 4	Ht4,FBbt:00003160,chamber 4,terminal cardiac chamber	1.0	Differential gene expression analysis between the two Tm9 subgroups at P50 indicated that one of them exclusively expressed Wnt4 while the other expressed Wnt10, similarly to TEv/d neurons.
PMC7790857	Dorsoventral division of visual circuits	1	1	TEv/d	FBbt:00058014	ventral transient extrinsic neuron of pupal optic lobe	TEv,FBbt:00058014,TEv neuron	1.0	Differential gene expression analysis between the two Tm9 subgroups at P50 indicated that one of them exclusively expressed Wnt4 while the other expressed Wnt10, similarly to TEv/d neurons.
PMC7790857	Dorsoventral division of visual circuits	1	2	Tm9v	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Since Wnt4-Gal4 expression overlapped only with ventral Tm9s (Fig5a), we named these subtypes Tm9v (Wnt4^+) and Tm9d (Wnt10^+).
PMC7790857	Dorsoventral division of visual circuits	1	3	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Sparse labeling of individual Tm9 neurons did not reveal any obvious morphological differences between these subtypes (Extended Data Fig12a).
PMC7790857	Dorsoventral division of visual circuits	1	5	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Even though these subtypes were statistically mostly indistinguishable in P70 and adult datasets, Wnt4 and Wnt10 expression were found in separate parts of the same cluster on the tSNE (Fig5c).
PMC7790857	Dorsoventral division of visual circuits	1	5	Wnt4	FBbt:00003160	adult heart chamber 4	Ht4,FBbt:00003160,chamber 4,terminal cardiac chamber	1.0	Even though these subtypes were statistically mostly indistinguishable in P70 and adult datasets, Wnt4 and Wnt10 expression were found in separate parts of the same cluster on the tSNE (Fig5c).
PMC7790857	Dorsoventral division of visual circuits	1	5	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Even though these subtypes were statistically mostly indistinguishable in P70 and adult datasets, Wnt4 and Wnt10 expression were found in separate parts of the same cluster on the tSNE (Fig5c).
PMC7790857	Dorsoventral division of visual circuits	1	6	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We also noticed that Wnt4-Gal4 expression was restricted to the ventral photoreceptors R7/R8 in pupae, but not in adult (Fig5a-b, Extended Data Fig12b-c).
PMC7790857	Dorsoventral division of visual circuits	2	3	brain	FBbt:00110636	adult cerebral ganglion	CRG,FBbt:00110636,SPG,adult supraesophageal ganglion,brain,cerebrum	1.0	In addition to the cell-autonomous differences during development that could enable these cells to connect with different synaptic partners, secreted Wnt ligands could differentially affect development and function of other neurons in ventral and dorsal parts of the brain (Supplementary Discussion).
PMC7790857	Dorsoventral division of visual circuits	3	1	Wnt4	FBbt:00003160	adult heart chamber 4	Ht4,FBbt:00003160,chamber 4,terminal cardiac chamber	1.0	Finally, we tested whether the differential expression of Wnt4 vs.
PMC7790857	Dorsoventral division of visual circuits	3	2	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Wnt10 observed in TE, Tm9 and R7/R8 neurons applied to other seemingly homogeneous neuronal types (Methods).
PMC7790857	Dorsoventral division of visual circuits	3	2	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Wnt10 observed in TE, Tm9 and R7/R8 neurons applied to other seemingly homogeneous neuronal types (Methods).
PMC7790857	Dorsoventral division of visual circuits	3	3	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	We found two other neurons with dorsoventral asymmetries: Tm4 neurons and the unidentified cluster 62 could be separated into Wnt4^+ and Wnt10^+ populations, with only ventral Tm4 neurons overlapping with Wnt4-Gal4 expression (Extended Data Fig12d-e).
PMC7790857	Dorsoventral division of visual circuits	3	4	Tm4	FBbt:00003792	transmedullary neuron Tm4	Tm4,FBbt:00003792	0.9999998807907104	For both Tm4 and cluster 62, Wnt4^+ and Wnt10^+ cells remained separated on the tSNE (Fig5c) but were highly similar: artificially separating them yielded an average OOBE across all stages around 25%.
PMC7790857	Dorsoventral division of visual circuits	3	4	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	For both Tm4 and cluster 62, Wnt4^+ and Wnt10^+ cells remained separated on the tSNE (Fig5c) but were highly similar: artificially separating them yielded an average OOBE across all stages around 25%.
PMC7790857	Dorsoventral division of visual circuits	3	6	Tm9d	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Interestingly, both Tm4d and Tm9d specifically expressed the serotonin receptor 5-HT1A in adult (Fig5d), raising the possibility that neuromodulatory signals are processed differently in ventral vs. dorsal visual circuits.
PMC7790857	Dorsoventral division of visual circuits	3	6	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Interestingly, both Tm4d and Tm9d specifically expressed the serotonin receptor 5-HT1A in adult (Fig5d), raising the possibility that neuromodulatory signals are processed differently in ventral vs. dorsal visual circuits.
PMC7790857	Conclusions	1	2	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Coupled with the available optic lobe connectomes [4], [6], this will provide an important resource for functional studies of adult neurons as well as for the identification of new mechanisms involved in circuit formation.
PMC7790857	Conclusions	1	3	neuropil	FBbt:00005139	neuropil	neuropil,FBbt:00005139	1.0	Our analyses revealed two intriguing populations of pupae-specific neurons that share many characteristics with the mammalian Cajal-Retzius cells and could be involved in neuropil development (Extended Data Fig9e).
PMC7790857	Conclusions	1	4	convergence	FBbt:00051207	larval mushroom body-lateral horn convergence neuron	larval CN,FBbt:00051207,larval convergence neuron	0.9244601130485535	We made several observations with important implications on how neural circuits are built (Extended Data Fig9f): We described the convergence of neuronal transcriptomes of the same type and generalized previous observations of increased transcriptomic diversity in neurons during development to the entire optic lobe circuit.
PMC7790857	Conclusions	1	5	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We showed that this is due to a transient upregulation of cell-type specific CSMs involved in synapse formation, which explains how neurons with indistinguishable transcriptomes in adult brains could nevertheless serve different functions due to their developmental history.
PMC7790857	Methods; Genetics	1	1	female	FBbt:00110417	adult fruitless aDT-b (female) neuron	female aDT-b neuron,FBbt:00110417,female aDT2 neuron,female fru-mAL neuron,female mAL neuron	0.854278564453125	All sequencing experiments in this study were performed with female D. melanogaster Canton-S maintained at 18-25°C (unless indicated otherwise) and dissected within 3 days of eclosion (adult dissections) or selected at P0 (white pupae) and maintained at 25°C until the required stage (pupal dissections).
PMC7790857	Methods; Genetics	1	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	All sequencing experiments in this study were performed with female D. melanogaster Canton-S maintained at 18-25°C (unless indicated otherwise) and dissected within 3 days of eclosion (adult dissections) or selected at P0 (white pupae) and maintained at 25°C until the required stage (pupal dissections).
PMC7790857	Methods; Genetics	2	1	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	Following final genotypes were used for the imaging experiments: Dm3 sparse labeling: hsFLP22/+; CyO/+; R25F07-Gal4/UAS-FSF-CD4-tdGFP.
PMC7790857	Methods; Genetics	2	2	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	TE neuron labeling: 10xUAS-myr:GFP/+; R10D10-Gal4/+ or Fs-Gal4/+; UAS-CD4:tdGFP.
PMC7790857	Methods; Genetics	2	2	neuron	FBbt:00001564	U neuron	U motor neuron,FBbt:00001564,U/CQ neuron	1.0	TE neuron labeling: 10xUAS-myr:GFP/+; R10D10-Gal4/+ or Fs-Gal4/+; UAS-CD4:tdGFP.
PMC7790857	Methods; Genetics	2	2	UAS-CD4:tdGFP	FBbt:00001788	female genital primordium (male)	RFP,FBbt:00001788,male repressed primordium,repressed female genital primordium,rfp	1.0	TE neuron labeling: 10xUAS-myr:GFP/+; R10D10-Gal4/+ or Fs-Gal4/+; UAS-CD4:tdGFP.
PMC7790857	Methods; Genetics	2	3	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Suppression of apoptosis in TE neurons: UAS-P35/+; UAS-myr-GFP/+; R10D10-Gal4/+.
PMC7790857	Methods; Genetics	2	4	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	TE neuron FLEXAMP: UAS-Flp; Gal80^ts/Cyo; Act>y+>LexA, LexAop-myr:GFP/R10D10-Gal4.
PMC7790857	Methods; Genetics	2	4	neuron	FBbt:00001564	U neuron	U motor neuron,FBbt:00001564,U/CQ neuron	1.0	TE neuron FLEXAMP: UAS-Flp; Gal80^ts/Cyo; Act>y+>LexA, LexAop-myr:GFP/R10D10-Gal4.
PMC7790857	Methods; Genetics	2	5	neuron	FBbt:00001564	U neuron	U motor neuron,FBbt:00001564,U/CQ neuron	1.0	Bsh FLEXAMP: UAS-Flp; Gal80^ts/Cyo; Act>y+>LexA, LexAop-myr:GFP/Bsh-Gal4 TE neuron sparse labeling: hsFLP2:PEST/+; UAS-FSF-CD4:tdGFP/+; R10D10-Gal4/+.
PMC7790857	Methods; Genetics	2	6	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Tm9 sparse labelling: hsFLP2:PEST; UAS-FSF-CD4:tdGFP/R72F01-p65AD; R82F10-Gal4DBD/TM6B or MKRS.
PMC7790857	Methods; Genetics	2	7	/TM2	FBbt:00058125	proximal pretarsal depressor muscle cell	long tendon muscle 2,FBbt:00058125,ltm2	0.8602836728096008	Wnt4-Gal4 and Tm9-LexA co-expression experiments: 10xUAS-IVSmCD8:RFP,13xLexAop2-mCD8:GFP; R82F10-LexA/Wnt4-Gal4; +/TM2.
PMC7790857	Methods; Genetics	2	8	GFP	FBbt:00001788	female genital primordium (male)	RFP,FBbt:00001788,male repressed primordium,repressed female genital primordium,rfp	1.0	Tm4-Gal4 and aop co-expression:;10xUAS-myr:GFP; R35H01-Gal4.
PMC7790857	Methods; Genetics	2	9	PR	FBbt:00003627	protocerebrum	PR,FBbt:00003627,protocerebral neuromere	1.0	PR stainings: Wnt4-Gal4, UAS-myr:GFP/Cyo; Tm2/Tm6B.
PMC7790857	Methods; Genetics	2	10	TmY4	FBbt:00003817	transmedullary Y neuron	TmY,FBbt:00003817	1.0	TmY4 labeling: Ac76E-LexA, P3-RFP/CyO; LexOpCD2-GFP/TM2.
PMC7790857	Methods; Genetics	2	11	TmY8	FBbt:00003817	transmedullary Y neuron	TmY,FBbt:00003817	1.0	TmY8 sparse labeling: pBPhsFlp2::PEST;; HA_V5_FLAG/CG42458-Gal4.
PMC7790857	Methods; Genetics	2	12	GFP	FBbt:00001788	female genital primordium (male)	RFP,FBbt:00001788,male repressed primordium,repressed female genital primordium,rfp	1.0	TmY14 labeling: 10xUAS-myr:GFP; R24F10-Gal4.
PMC7790857	Methods; Genetics	2	14	AD	FBbt:00047119	larval anterior dorsal commissure	aD,FBbt:00047119,larval antero-dorsal commissure	1.0	AD; R55F01-GAL4.
PMC7790857	Methods; Genetics	2	15	DBD/+	FBbt:00001318	support cell of the dorsal bipolar dendritic cell	DBD support glia,FBbt:00001318,DBDG,SDBP	1.0	DBD/+.
PMC7790857	Methods; Genetics	2	16	LC17	FBbt:00111752	lobula columnar neuron LC17	LC17,FBbt:00111752	1.0	LC17 labeling;; 10xUAS-myr:GFP/+; R92G12-Gal4/+ or; 10xUAS-myr:GFP/R21D03-p65.
PMC7790857	Methods; Genetics	2	17	AD	FBbt:00047119	larval anterior dorsal commissure	aD,FBbt:00047119,larval antero-dorsal commissure	1.0	AD; R65C12-GAL4.
PMC7790857	Methods; Genetics	2	18	DBD/+	FBbt:00001318	support cell of the dorsal bipolar dendritic cell	DBD support glia,FBbt:00001318,DBDG,SDBP	1.0	DBD/+.
PMC7790857	Methods; Single-cell RNA sequencing; Sample Preparation	1	1	SIM	FBbt:00047427	adult SIFamide cell of pars intercerebralis	SIFa,FBbt:00047427,SIFamide	1.0	Fly brains were dissected in ice-cold Schneider’s Insect Medium (SIM, Gibco) and incubated at 25°C for 1.5 hours (adult brains) or 30 minutes (pupal brains) in a dissociation solution of SIM with 2mg/mL Collagenase (Sigma) and 2mg/mL Dispase (Sigma).
PMC7790857	Methods; Single-cell RNA sequencing; Sample Preparation	1	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Fly brains were dissected in ice-cold Schneider’s Insect Medium (SIM, Gibco) and incubated at 25°C for 1.5 hours (adult brains) or 30 minutes (pupal brains) in a dissociation solution of SIM with 2mg/mL Collagenase (Sigma) and 2mg/mL Dispase (Sigma).
PMC7790857	Methods; Single-cell RNA sequencing; Sample Preparation	1	2	D	FBbt:00048431	adult abdominal dorsal multidendritic neuron ddaC	D neuron,FBbt:00048431	0.8554139137268066	Towards the end of incubation, we placed all appropriate reagents (as indicated in the Chromium™ Single Cell 3’ Reagent Kits v2 User Guide - Rev D) to equilibrate at room temperature.
PMC7790857	Methods; Single-cell RNA sequencing; Sample Preparation	1	3	SIM	FBbt:00047427	adult SIFamide cell of pars intercerebralis	SIFa,FBbt:00047427,SIFamide	1.0	We then washed once the whole brains with ice-cold SIM, separated the optic lobes, washed them 3 times with ice-cold Dulbecco’s Phosphate-Buffered Saline (DPBS, without calcium & magnesium, Corning/Fisher) + 0.04% Bovine Serum Albumin (BSA, Sigma), and transferred them into a low-bind tube on ice (150 μL ice-cold DPBS + 0.04% BSA for 12 optic lobes).
PMC7790857	Methods; Single-cell RNA sequencing; Sample Preparation	1	3	BSA	FBbt:00004305	posterior supraalar bristle	pSA,FBbt:00004305	0.8550272583961487	We then washed once the whole brains with ice-cold SIM, separated the optic lobes, washed them 3 times with ice-cold Dulbecco’s Phosphate-Buffered Saline (DPBS, without calcium & magnesium, Corning/Fisher) + 0.04% Bovine Serum Albumin (BSA, Sigma), and transferred them into a low-bind tube on ice (150 μL ice-cold DPBS + 0.04% BSA for 12 optic lobes).
PMC7790857	Methods; Single-cell RNA sequencing; Sample Preparation	1	6	media	FBbt:00004762	wing vein L4	cubitus vein,FBbt:00004762,media 1,medial posterior and cubitus anterior,median vein,putative first branch of medial vein	0.9121362566947937	Limiting the number of pipetting repetitions increased the number of cells recovered and limited the amount of ambient RNA released from damaged cells into the media.
PMC7790857	Methods; Single-cell RNA sequencing; Sample Preparation	2	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	All adult brains were dissected between 9-12am.
PMC7790857	Methods; Single-cell RNA sequencing; Sample Preparation	2	2	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Two adult experiments also included male flies; these cells were removed from the dataset in downstream analysis.
PMC7790857	Methods; Single-cell RNA sequencing; Sample Preparation	2	2	male	FBbt:00110579	adult fruitless aDT-b (male) neuron	male aDT-b neuron,FBbt:00110579,male aDT2 neuron,male fru-mAL neuron,male mAL neuron	0.9036915302276611	Two adult experiments also included male flies; these cells were removed from the dataset in downstream analysis.
PMC7790857	Methods; Library preparation, sequencing and processing	1	2	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We prepared 15 libraries from adult brains, 5 libraries each from P15, P30 and P70 brains and 4 libraries each from P40 and P50 brains.
PMC7790857	Methods; Library preparation, sequencing and processing	2	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We mapped the sequenced libraries to the D. melanogaster genome assembly BDGP6.88 using CellRanger 2.1.0 for the adult stage and 3.0.1 for the pupal stages.
PMC7790857	Methods; Library preparation, sequencing and processing	2	1	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	We mapped the sequenced libraries to the D. melanogaster genome assembly BDGP6.88 using CellRanger 2.1.0 for the adult stage and 3.0.1 for the pupal stages.
PMC7790857	Methods; Library preparation, sequencing and processing	2	3	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	Note that the incorporation of EmptyDrops algorithm in CellRanger v3 excluded further cells with >1000 UMIs predicted to contain only ambient RNA for pupal datasets.
PMC7790857	Methods; Library preparation, sequencing and processing	2	4	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	In addition, for the two experiments that included male cells at the adult stage, we removed all cell barcodes with at least one UMI of any of the genes of the male-specific lethal (MSL) complex (msl-1, msl-2, msl-3, mof, mle, roX1, roX2).
PMC7790857	Methods; Library preparation, sequencing and processing	2	4	mle	FBbt:00005408	mushroom body medial lobe	ML,FBbt:00005408,horizontal lobe of mushroom body,medial branch of mushroom body,medial lobe,medial lobe of mushroom body	0.9137424230575562	In addition, for the two experiments that included male cells at the adult stage, we removed all cell barcodes with at least one UMI of any of the genes of the male-specific lethal (MSL) complex (msl-1, msl-2, msl-3, mof, mle, roX1, roX2).
PMC7790857	Methods; Library preparation, sequencing and processing	2	7	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	After processing, the adult dataset comprised 109,743 cells passing quality filters, with a median of 1805 UMIs and 903 genes per cell.
PMC7790857	Methods; Library preparation, sequencing and processing	2	8	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	The pupal dataset comprised 31,036 cells passing quality control filters at P15, 35,758 cells at P30, 24,084 cells at P40, 31,340 cells at P50 and 43,740 cells at P70.
PMC7790857	Methods; RNA sequencing of FACS-sorted cell types	1	2	VT	FBbt:00000508	prothoracic ventral transverse muscle cell	VT,FBbt:00000508	1.0	50240), T4-Gal4 (VT stock no. 37588)) as well as pan-neuronal marker line (Elav-Gal4) and pan-glial marker line (Repo-Gal4) to UAS-Red Stinger to fluorescently label nuclei of individual cell types, sort and sequence them as previously described [18].
PMC7790857	Methods; RNA sequencing of FACS-sorted cell types	1	3	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Briefly, we first dissected adult optic lobes, then dissociated tissue while maintaining cell viability and finally, sorted cells by FACS (Facs Aria III) based on their differences in fluorescence intensity and cell size.
PMC7790857	Methods; RNA sequencing of FACS-sorted cell types	1	4	cDNA	FBbt:00047512	descending neuron of the anterior dorsal brain	DNa,FBbt:00047512	0.8771221041679382	RNA was extracted using the Arcturus PicoPure RNA Isolation Kit (Applied Biosystems) and the Smart-Seq v4 Ultra Low Input RNA Kit (Clontech) was used to generate full-length double stranded cDNA with 300 to 500 pg of total RNA input.
PMC7790857	Methods; RNA sequencing of FACS-sorted cell types	1	5	cDNA	FBbt:00047512	descending neuron of the anterior dorsal brain	DNa,FBbt:00047512	0.8771221041679382	The quality of RNA and cDNA was assessed by Bioanalyzer using RNA 6000 Pico and High sensitivity DNA assay (Agilent) respectively.
PMC7790857	Methods; RNA sequencing of FACS-sorted cell types	1	6	NYUAD	FBbt:00006024	larval dorsal multidendritic neuron ddaF	ddaD,FBbt:00006024	1.0	Libraries were prepared using Nextera XT DNA Library Prep Kit (Illumina) and run on the Illumina HiSeq 2500 (CGSB at NYUAD).
PMC7790857	Methods; RNA sequencing of FACS-sorted cell types	1	8	Drosophila	FBbt:00000001	organism	Drosophila,FBbt:00000001,whole organism	1.0	Sequences were mapped to the Drosophila melanogaster genome (BDGP6.81) using TopHat2 (v2.1.0).
PMC7790857	Methods; Antibody generation	3	1	HPSQHSHPPQ	FBbt:00047207	adult midgut-hindgut hybrid zone	HPZ,FBbt:00047207,adult HZ,adult Wg ring,adult midgut-hindgut boundary,anterior SCZ,anterior spindle cell zone,hindgut proliferation zone,midgut/hindgut imaginal ring	1.0	MAMLNEASLS PADAHAHANA TTPTHSKAAA MASATTMLTT KTPFSIEHIL FQNLNSASNN NNSSDTNGIA ANTNNYAPKS SRNAVKSARS AFAHDNNPHK HPSQHSHPPQ SHPPASASAS ATATARSNQA ASGYAGEDYG KSMHSTPRSN HHSRHGTSHY NGDQISQQLG SGAAQHPPVP TTQPQPPPPP PLNGGSGASN GVLYPNAPYT DHGFLQMTLG YLSPSSGTYK SVDPYFLSQA SLFGGAPFFG APGCVPELAL GLGMGVNALR HCRRRKARTV FSDPQLSGLE KRFEGQRYLS TPERVELATA LGLSETQVKT WFQNRRMKHK KQLRRRDNAN EPVDFSRSEP GKQPGEATSS SGDSKHGKLN PGSVGGTPTQ PTSEQQLQMC LMQQGYSTDD YSDLEADSGD EDNSSDVDIV GDAKLYQLT
PMC7790857	Methods; Antibody generation	10	1	Toy	FBbt:00004842	epandrial ventral lobe	lateral plate,FBbt:00004842,pouch,toe	1.0	Polyclonal antibody against Toy was generated by Thermo Scientific, using an epitope with the following amino acids to immunize rabbits:
PMC7790857	Methods; Immunohistochemistry	1	1	SIM	FBbt:00047427	adult SIFamide cell of pars intercerebralis	SIFa,FBbt:00047427,SIFamide	1.0	Brains were dissected in ice-cold SIM, fixed in 3.7% formaldehyde (in PBS) at room temperature for 30-50 minutes, washed in PBST (PBS + 0.3% Triton X-100) and incubated for an hour in blocking solution (PBST + 5% horse serum), which we also used to dilute all primary and secondary antibody solutions.
PMC7790857	Methods; Immunohistochemistry	1	1	secondary	FBbt:00047096	secondary neuron	adult-specific neuron,FBbt:00047096,postembryonic neuron	0.9600140452384949	Brains were dissected in ice-cold SIM, fixed in 3.7% formaldehyde (in PBS) at room temperature for 30-50 minutes, washed in PBST (PBS + 0.3% Triton X-100) and incubated for an hour in blocking solution (PBST + 5% horse serum), which we also used to dilute all primary and secondary antibody solutions.
PMC7790857	Methods; Immunohistochemistry	1	2	secondary	FBbt:00047096	secondary neuron	adult-specific neuron,FBbt:00047096,postembryonic neuron	0.9600140452384949	They were incubated in primary antibodies for 1 or 2 days at 4°C, washed three times in PBST for 10 minutes and then incubated in secondary antibodies at 4°C overnight followed by washing in PBST again 3×10min.
PMC7790857	Methods; Immunohistochemistry	1	3	imaged	FBbt:00003004	adult	imago,FBbt:00003004	0.8784415125846863	They were then mounted in Slowfade and imaged with a Leica SP8 confocal microscope using a 20x (NA=0.75) or a 63x (NA=1.3) glycerol objective.
PMC7790857	Methods; Immunohistochemistry	1	4	ImageJ	FBbt:00003004	adult	imago,FBbt:00003004	0.9466856122016907	Images were processed with ImageJ or Imaris.
PMC7790857	Methods; Immunohistochemistry	2	1	primary	FBbt:00047097	primary neuron	embryonic lineage neuron,FBbt:00047097,embryonic neuron,larval neuron,primary lineage neuron	0.9419446587562561	The following primary antibodies were used: Polyclonal rabbit anti-RFP (1:500), Polyclonal rabbit anti-cleaved Dcp-1 Antibody (1:100). sheep anti-GFP (1:200), chicken anti-GFP (1:100), Rabbit anti-PRT (1/100), rabbit anti-GFP (1:250), mouse anti-aop (1:100), rat anti-NCad (1:20), rabbit anti-Bi (1:400), mouse anti-Chaoptin (1:50), rabbit anti-Bsh (1:1800), guinea pig anti-Hth (1:100), rabbit anti-Dve (1:250), mouse anti-Cut (1:20), mouse anti-Acj6 (1:20), rabbit anti-Toy (1:250), rat anti-FLAG (1:200), guinea pig anti-Dichaete (D) (1:50), guinea pig anti-Vvl (1:100), mouse anti-Dac (1:20), mouse anti-Brp (nc82) (1:30).
PMC7790857	Methods; Immunohistochemistry	3	1	secondary	FBbt:00047096	secondary neuron	adult-specific neuron,FBbt:00047096,postembryonic neuron	0.9600140452384949	The following secondary antibodies (all donkey, used at 1:400) were used: anti-sheep Alexa 488, anti-chicken Alexa 488, anti-rabbit Alexa 488, anti-rabbit Cy3, anti-mouse Cy3, anti-rat Alexa 555, anti-rat Alexa 647, anti-guinea pig Alexa 488, anti-guinea pig Alexa 647, anti-guinea pig Cy3, anti-rat Alexa 405, anti-rabbit Alexa 647, anti-mouse Alexa 647.
PMC7790857	Methods; Data Analysis and Statistics; Integration of scRNA-Seq libraries	2	2	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	For the adult stage, we then used the functions FindIntegrationAnchors, IntegrateData, ScaleData and RunPCA with default parameters, except for the dimensionality for which we tried the values 100, 150 and 200.
PMC7790857	Methods; Data Analysis and Statistics; Integration of scRNA-Seq libraries	2	4	cell	FBbt:00004781	wing basal cell 1	C' cell,FBbt:00004781	1.0	This function counts, for each cell of a given library, how many of its 100 closest neighbors in this library are similar before and after integration.
PMC7790857	Methods; Data Analysis and Statistics; Integration of scRNA-Seq libraries	2	7	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We therefore chose a dimensionality of 150 for the adult dataset.
PMC7790857	Methods; Data Analysis and Statistics; Integration of scRNA-Seq libraries	2	8	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	This procedure conserved the local structure of each dataset, as the cells shared on average 81% of their closest neighbors before and after integration, and efficiently removed the batch effects, as our final adult clusters contained a uniform distribution of cells from each original library (Extended Data Fig1b).
PMC7790857	Methods; Data Analysis and Statistics; Integration of scRNA-Seq libraries	2	9	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	Lastly, we used a dimensionality of 100 for all pupal datasets due to their smaller sizes.
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	1	1	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	We used Seurat 3.0.0.9000 to cluster our integrated single-cell transcriptomes to identify groups of cells with similar gene expression patterns.
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	1	2	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	For the adult dataset we used the functions FindNeighbors and FindClusters with default parameters except for the number of principal components (PCs), which are used to reduce the dataset dimensionality and calculate the distance between all pairs of cells, and the resolution, which is used to compensate for the tendency of modularity optimization algorithms to merge small clusters.
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	2	1	PC	FBbt:00001343	central protocerebral neuroblast	Pc,FBbt:00001343	1.0	We varied the PC number between 100 and 200 (with a step size of 20), and the resolution between 1 and 15 (step size of 1), which yielded between 146 and 229 clusters (Extended Data Fig1c).
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	2	2	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	We assessed the biological significance of the clusters obtained with each pair of clustering parameters by using 54 log-normalized bulk-transcriptomes obtained from purified optic lobe neuronal types: 52 published before [18], [20] and 2 additional (Pm2 and T4) sequenced for this study.
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	2	2	Pm2	FBbt:00003835	proximal medullary amacrine neuron Pm2	Pm2,FBbt:00003835	1.0	We assessed the biological significance of the clusters obtained with each pair of clustering parameters by using 54 log-normalized bulk-transcriptomes obtained from purified optic lobe neuronal types: 52 published before [18], [20] and 2 additional (Pm2 and T4) sequenced for this study.
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	2	2	T4	FBbt:00003731	T neuron T4	T4,FBbt:00003731	1.0	We assessed the biological significance of the clusters obtained with each pair of clustering parameters by using 54 log-normalized bulk-transcriptomes obtained from purified optic lobe neuronal types: 52 published before [18], [20] and 2 additional (Pm2 and T4) sequenced for this study.
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	2	3	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	For each purified neuronal-type transcriptome, we calculated the Pearson correlation with the average log-normalized non-integrated gene expression of each cluster, using the list of the most variable genes found during the clustering step.
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	2	5	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	If a cluster has a much higher correlation value than the others, the cells from this cluster are very likely to belong to this neuronal type.
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	2	7	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Thus, we counted for each pair of clustering parameters how many of the 54 isolated neuronal-types match to 1 to 5 clusters (i.e. we tested for the 6 best-correlated clusters for each neuronal type whether the difference in correlation value between a cluster and the subsequent one was higher than 0.05).
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	3	1	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	For clustering the pupal datasets, we also used 120 PCs but a lower resolution of 6 due to their smaller size.
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	3	1	lower	FBbt:00110191	lower toe of larval mushroom body medial lobe	MAML,FBbt:00110191,MB-MA,axonal side branches,bulbous swelling,lower toe,ma,medial appendix of larval mushroom body	0.8997003436088562	For clustering the pupal datasets, we also used 120 PCs but a lower resolution of 6 due to their smaller size.
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	3	3	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We did not perform additional parameter tuning for either integration or clustering of these datasets, nor did we comprehensively assess the quality of these unsupervised clusters (as we do below for adult), because the pupal datasets were primarily annotated in a supervised manner using log-normalized non-integrated expression matrices.
PMC7790857	Methods; Data Analysis and Statistics; Clustering of the datasets	3	3	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	We did not perform additional parameter tuning for either integration or clustering of these datasets, nor did we comprehensively assess the quality of these unsupervised clusters (as we do below for adult), because the pupal datasets were primarily annotated in a supervised manner using log-normalized non-integrated expression matrices.
PMC7790857	Methods; Data Analysis and Statistics; Statistical significance of the clusters	1	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Because keeping small clusters separate using a modularity optimization algorithm results in artificially splitting large clusters [46], before annotation of the adult dataset we merged all pairs of clusters that were improperly separated (Extended Data Fig1e-f).
PMC7790857	Methods; Data Analysis and Statistics; Statistical significance of the clusters	1	3	cell	FBbt:00004781	wing basal cell 1	C' cell,FBbt:00004781	1.0	For each node, we then trained a random-forest model using the Seurat v2 function AssessNodes to predict to which branch of the node a given cell should be assigned.
PMC7790857	Methods; Data Analysis and Statistics; Statistical significance of the clusters	1	10	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	They are thus still accessible to study in our adult dataset since the metadata field ‘Clustering’ contains the initial unsupervised clusters identities.
PMC7790857	Methods; Data Analysis and Statistics; Statistical significance of the clusters	2	1	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Similarly, we used the Seurat v2 function BuildClusterTree on the T4/T5 subtypes (Extended Data Fig10), and the function AssessNodes to evaluate the statistical significance of the separation between several pairs of cluster throughout this study (Dm3a/b, Tm9v/d, Tm4v/d, cluster 62 Wnt4^+/Wnt10^- and Wnt4^-/Wnt10^+ cells) and during the process of annotating the pupal stages (see below).
PMC7790857	Methods; Data Analysis and Statistics; Statistical significance of the clusters	2	1	Tm9v/d	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Similarly, we used the Seurat v2 function BuildClusterTree on the T4/T5 subtypes (Extended Data Fig10), and the function AssessNodes to evaluate the statistical significance of the separation between several pairs of cluster throughout this study (Dm3a/b, Tm9v/d, Tm4v/d, cluster 62 Wnt4^+/Wnt10^- and Wnt4^-/Wnt10^+ cells) and during the process of annotating the pupal stages (see below).
PMC7790857	Methods; Data Analysis and Statistics; Statistical significance of the clusters	2	1	Tm4v/d	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Similarly, we used the Seurat v2 function BuildClusterTree on the T4/T5 subtypes (Extended Data Fig10), and the function AssessNodes to evaluate the statistical significance of the separation between several pairs of cluster throughout this study (Dm3a/b, Tm9v/d, Tm4v/d, cluster 62 Wnt4^+/Wnt10^- and Wnt4^-/Wnt10^+ cells) and during the process of annotating the pupal stages (see below).
PMC7790857	Methods; Data Analysis and Statistics; Statistical significance of the clusters	2	1	Wnt4	FBbt:00003160	adult heart chamber 4	Ht4,FBbt:00003160,chamber 4,terminal cardiac chamber	1.0	Similarly, we used the Seurat v2 function BuildClusterTree on the T4/T5 subtypes (Extended Data Fig10), and the function AssessNodes to evaluate the statistical significance of the separation between several pairs of cluster throughout this study (Dm3a/b, Tm9v/d, Tm4v/d, cluster 62 Wnt4^+/Wnt10^- and Wnt4^-/Wnt10^+ cells) and during the process of annotating the pupal stages (see below).
PMC7790857	Methods; Data Analysis and Statistics; Differential gene expression analysis	1	2	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	We then selected the 5, 10 or 20 highest most differentially expressed genes based of their log fold-change (called top5-20 cluster markers), in either all clusters (when not indicated), a subset of them (when indicated) or two subpopulations of cells from the same cluster (when indicated).
PMC7790857	Methods; Data Analysis and Statistics; Binarization of gene expression (Mixture modelling)	1	3	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	In a given cluster, low UMI levels for a gene can indicate an expression level that is either sufficient or insufficient to produce a functional amount of protein, but also contamination of the cluster by another cell type or presence of this gene in the ambient RNA.
PMC7790857	Methods; Data Analysis and Statistics; Binarization of gene expression (Mixture modelling)	3	3	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Moreover, as cluster 192 contains ambient RNA, its expression levels are not representative of genuine cell types and we removed it from each dataset before mixture modelling.
PMC7790857	Methods; Data Analysis and Statistics; Binarization of gene expression (Mixture modelling)	3	4	immature	FBbt:00051423	developing neuron	differentiating neuron,FBbt:00051423,immature neuron	0.9716971516609192	Similarly, we removed NBs, GMCs, and clusters of immature neurons in the P15 dataset as they could be mixtures of multiple cell types.
PMC7790857	Methods; Data Analysis and Statistics; Binarization of gene expression (Mixture modelling)	4	4	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	Moreover, for genes not expressed in the optic lobe, a few cells in our dataset might still have a UMI of this gene by chance, and mixture modelling will consider the gene ON in the clusters containing these cells.
PMC7790857	Methods; Data Analysis and Statistics; Binarization of gene expression (Mixture modelling)	4	5	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	If this affects a sufficient number of genes in a dataset, it will lower the average expression levels corresponding to the ON state across bimodal genes, and therefore artificially increase the number of unimodal genes considered to be ON (unimodal genes represent 6.4% of the genes in our adult dataset).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	1	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	In order to assign the adult clusters to specific cell types, we first aimed at distinguishing neuronal and glial clusters by calculating Pearson correlations between the average gene expression profile of each cluster and transcriptomes sequenced from FACS sorted populations of neurons (elav-Gal4) or glia (repo-Gal4).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	1	1	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	In order to assign the adult clusters to specific cell types, we first aimed at distinguishing neuronal and glial clusters by calculating Pearson correlations between the average gene expression profile of each cluster and transcriptomes sequenced from FACS sorted populations of neurons (elav-Gal4) or glia (repo-Gal4).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	1	1	glia	FBbt:00100497	adult glial cell	glia,FBbt:00100497	1.0	In order to assign the adult clusters to specific cell types, we first aimed at distinguishing neuronal and glial clusters by calculating Pearson correlations between the average gene expression profile of each cluster and transcriptomes sequenced from FACS sorted populations of neurons (elav-Gal4) or glia (repo-Gal4).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	1	2	lower	FBbt:00110191	lower toe of larval mushroom body medial lobe	MAML,FBbt:00110191,MB-MA,axonal side branches,bulbous swelling,lower toe,ma,medial appendix of larval mushroom body	0.8997003436088562	In addition, we also identified clusters containing low quality transcriptomes using features tending to be higher (proportions of UMI from mitochondrial genes) or lower (number of UMIs or genes per cell) in low quality cells  [47], [48].
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	1	5	Cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Cluster 192 is made mainly of low quality transcriptomes, which seem to originate largely from “ambient RNA” released by glial cells broken during brain dissociation (Suppl.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	To further annotate neuronal transcriptomes, the Pearson correlations between the average log-normalized non-integrated gene expression of our clusters and log-normalized transcriptomes of isolated neuronal populations was first done using the 610 top10 cluster markers of the adult dataset (i.e. the genes ranked among the top 10 most differentially expressed genes for at least one of our clusters when compared to all other clusters).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	2	Pm3	FBbt:00110066	proximal medullary amacrine neuron Pm3	Pm3,FBbt:00110066	1.0	All neuronal types except Pm3, LC6, LC10b, LC16, and LPi3-4 displayed a clear match to a single cluster as evidenced by an obvious correlation gap (of at least 0.05) between the best and second-best cluster matches (Fig1c, Extended Data Fig3).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	2	LC6	FBbt:00003876	lobula columnar neuron LC6	LC06,FBbt:00003876,LC6,S4,lobula columnar neuron Lcn6,lobular columnar neuron Lcn6	1.0	All neuronal types except Pm3, LC6, LC10b, LC16, and LPi3-4 displayed a clear match to a single cluster as evidenced by an obvious correlation gap (of at least 0.05) between the best and second-best cluster matches (Fig1c, Extended Data Fig3).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	2	LC10b	FBbt:00111745	lobula columnar neuron LC10b	LC10b,FBbt:00111745	1.0	All neuronal types except Pm3, LC6, LC10b, LC16, and LPi3-4 displayed a clear match to a single cluster as evidenced by an obvious correlation gap (of at least 0.05) between the best and second-best cluster matches (Fig1c, Extended Data Fig3).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	2	LC16	FBbt:00111751	lobula columnar neuron LC16	LC16,FBbt:00111751	1.0	All neuronal types except Pm3, LC6, LC10b, LC16, and LPi3-4 displayed a clear match to a single cluster as evidenced by an obvious correlation gap (of at least 0.05) between the best and second-best cluster matches (Fig1c, Extended Data Fig3).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	2	LPi3-4	FBbt:00111289	lobula plate intrinsic neuron LPi3-4	LPi3-4,FBbt:00111289	1.0	All neuronal types except Pm3, LC6, LC10b, LC16, and LPi3-4 displayed a clear match to a single cluster as evidenced by an obvious correlation gap (of at least 0.05) between the best and second-best cluster matches (Fig1c, Extended Data Fig3).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	3	T4	FBbt:00003731	T neuron T4	T4,FBbt:00003731	1.0	T4 and T5 cells both matched to the largest cluster, a case discussed in detail in main text.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	4	Pm3	FBbt:00110066	proximal medullary amacrine neuron Pm3	Pm3,FBbt:00110066	1.0	The Pm3 transcriptome correlated best, but weakly, with cluster 151 which we verified to be the correct Pm3 cluster based on its expression of previously described markers  [13], [19] (Extended Data Fig3).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	4	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	The Pm3 transcriptome correlated best, but weakly, with cluster 151 which we verified to be the correct Pm3 cluster based on its expression of previously described markers  [13], [19] (Extended Data Fig3).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	5	LC10b	FBbt:00111745	lobula columnar neuron LC10b	LC10b,FBbt:00111745	1.0	The LC10b transcriptome correlated best with cluster 79, but also well though more weakly with clusters 93, 78 (corresponding to LC10d) and 77 (LC10a).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	5	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	The LC10b transcriptome correlated best with cluster 79, but also well though more weakly with clusters 93, 78 (corresponding to LC10d) and 77 (LC10a).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	5	LC10d	FBbt:00111746	lobula columnar neuron LC10c	LC10c,FBbt:00111746	1.0	The LC10b transcriptome correlated best with cluster 79, but also well though more weakly with clusters 93, 78 (corresponding to LC10d) and 77 (LC10a).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	5	LC10a	FBbt:00111747	lobula columnar neuron LC10a	LC10a,FBbt:00111747	1.0	The LC10b transcriptome correlated best with cluster 79, but also well though more weakly with clusters 93, 78 (corresponding to LC10d) and 77 (LC10a).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	6	LC10b	FBbt:00111745	lobula columnar neuron LC10b	LC10b,FBbt:00111745	1.0	Thus, we assigned LC10b identity to cluster 79, cluster 93 likely being LC10c (for which we did not have a bulk transcriptome).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	6	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Thus, we assigned LC10b identity to cluster 79, cluster 93 likely being LC10c (for which we did not have a bulk transcriptome).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	6	LC10c	FBbt:00111746	lobula columnar neuron LC10c	LC10c,FBbt:00111746	1.0	Thus, we assigned LC10b identity to cluster 79, cluster 93 likely being LC10c (for which we did not have a bulk transcriptome).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	7	LC6	FBbt:00003876	lobula columnar neuron LC6	LC06,FBbt:00003876,LC6,S4,lobula columnar neuron Lcn6,lobular columnar neuron Lcn6	1.0	LC6 matched best with cluster 97, which we split into clusters 221 and 222 (see the section “Backprojection of the developmental splits”).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	7	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	LC6 matched best with cluster 97, which we split into clusters 221 and 222 (see the section “Backprojection of the developmental splits”).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	8	Cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Cluster 222 then matched best with LC6, while the next best ranking clusters where other LC cells.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	8	LC6	FBbt:00003876	lobula columnar neuron LC6	LC06,FBbt:00003876,LC6,S4,lobula columnar neuron Lcn6,lobular columnar neuron Lcn6	1.0	Cluster 222 then matched best with LC6, while the next best ranking clusters where other LC cells.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	9	LC16	FBbt:00111751	lobula columnar neuron LC16	LC16,FBbt:00111751	1.0	LC16 matched best with cluster 100, but with a correlation gap of only 0.03.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	10	LC	FBbt:00000399	lateral cephalic tracheal branch	LC,FBbt:00000399	1.0	As LC transcriptomes seem very similar (as illustrated by the examples above), we believe this explains the relatively small correlation gap for LC16: the third best ranking clusters was cluster 222, which we identified as LC6.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	10	LC16	FBbt:00111751	lobula columnar neuron LC16	LC16,FBbt:00111751	1.0	As LC transcriptomes seem very similar (as illustrated by the examples above), we believe this explains the relatively small correlation gap for LC16: the third best ranking clusters was cluster 222, which we identified as LC6.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	10	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	As LC transcriptomes seem very similar (as illustrated by the examples above), we believe this explains the relatively small correlation gap for LC16: the third best ranking clusters was cluster 222, which we identified as LC6.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	10	LC6	FBbt:00003876	lobula columnar neuron LC6	LC06,FBbt:00003876,LC6,S4,lobula columnar neuron Lcn6,lobular columnar neuron Lcn6	1.0	As LC transcriptomes seem very similar (as illustrated by the examples above), we believe this explains the relatively small correlation gap for LC16: the third best ranking clusters was cluster 222, which we identified as LC6.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	13	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	After this, and after backprojection of developmental splits (such as the separation of cluster 97 into 221 and 222, as described below), our final adult dataset contained 587 top10 cluster markers, which we used for the figures of this paper (including Extended Data Figs. 2 and 3).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	13	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	After this, and after backprojection of developmental splits (such as the separation of cluster 97 into 221 and 222, as described below), our final adult dataset contained 587 top10 cluster markers, which we used for the figures of this paper (including Extended Data Figs. 2 and 3).
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	2	14	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	The identification of clusters without comparison to a reference transcriptome was primarily done using mixture modelling of known markers (Extended Data Fig4), and is detailed in length for each cluster in Supplementary Table 1, Extended Data Fig 4.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	3	1	Tm4	FBbt:00003792	transmedullary neuron Tm4	Tm4,FBbt:00003792	0.9999998807907104	As explained in main text we could manually split Tm9, Tm4 and cluster 62 in a Wnt4+ and a Wnt10+ subpopulations at the adult stage.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	3	1	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	As explained in main text we could manually split Tm9, Tm4 and cluster 62 in a Wnt4+ and a Wnt10+ subpopulations at the adult stage.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	3	1	Wnt4	FBbt:00003160	adult heart chamber 4	Ht4,FBbt:00003160,chamber 4,terminal cardiac chamber	1.0	As explained in main text we could manually split Tm9, Tm4 and cluster 62 in a Wnt4+ and a Wnt10+ subpopulations at the adult stage.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	3	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	As explained in main text we could manually split Tm9, Tm4 and cluster 62 in a Wnt4+ and a Wnt10+ subpopulations at the adult stage.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	3	3	Wnt4	FBbt:00003160	adult heart chamber 4	Ht4,FBbt:00003160,chamber 4,terminal cardiac chamber	1.0	This is explained by the fact that for a given neuronal type, Wnt4+ and Wnt10+ cells are extremely similar: only a few genes (Wnt4, Wnt10, mamo, frizzled, and a few others out of thousands) show a statistically significant differential expression, which is not enough for unsupervised algorithm to differentiate the cells.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	3	3	mamo	FBbt:00110191	lower toe of larval mushroom body medial lobe	MAML,FBbt:00110191,MB-MA,axonal side branches,bulbous swelling,lower toe,ma,medial appendix of larval mushroom body	1.0	This is explained by the fact that for a given neuronal type, Wnt4+ and Wnt10+ cells are extremely similar: only a few genes (Wnt4, Wnt10, mamo, frizzled, and a few others out of thousands) show a statistically significant differential expression, which is not enough for unsupervised algorithm to differentiate the cells.
PMC7790857	Methods; Data Analysis and Statistics; Annotation of the adult dataset	3	4	Wnt4	FBbt:00003160	adult heart chamber 4	Ht4,FBbt:00003160,chamber 4,terminal cardiac chamber	1.0	However, since some of those genes are biologically significant and clearly differentially expressed (Fig5, Extended Data Fig12), the division into Wnt4+ and Wnt10+ subtypes is genuine.
PMC7790857	Methods; Data Analysis and Statistics; An artificial neural network model to classify single cell transcriptomes	1	1	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	We sought to annotate the pupal datasets using our new, expanded adult atlas as a reference.
PMC7790857	Methods; Data Analysis and Statistics; An artificial neural network model to classify single cell transcriptomes	1	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We sought to annotate the pupal datasets using our new, expanded adult atlas as a reference.
PMC7790857	Methods; Data Analysis and Statistics; An artificial neural network model to classify single cell transcriptomes	3	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Using the Python library Keras, we therefore trained a NN with a single hidden layer to classify our adult dataset, using a randomly selected 90% sample of the dataset while the remaining 10% served as a validation set.
PMC7790857	Methods; Data Analysis and Statistics; An artificial neural network model to classify single cell transcriptomes	3	3	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	As these marker genes were calculated on the initial adult dataset, before adjustments such as the separation of Tm9 cluster into Tm9v/d, these genes differ very slightly from the 587 top10 cluster markers of our final adult dataset.
PMC7790857	Methods; Data Analysis and Statistics; An artificial neural network model to classify single cell transcriptomes	3	3	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	As these marker genes were calculated on the initial adult dataset, before adjustments such as the separation of Tm9 cluster into Tm9v/d, these genes differ very slightly from the 587 top10 cluster markers of our final adult dataset.
PMC7790857	Methods; Data Analysis and Statistics; An artificial neural network model to classify single cell transcriptomes	3	3	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	As these marker genes were calculated on the initial adult dataset, before adjustments such as the separation of Tm9 cluster into Tm9v/d, these genes differ very slightly from the 587 top10 cluster markers of our final adult dataset.
PMC7790857	Methods; Data Analysis and Statistics; An artificial neural network model to classify single cell transcriptomes	3	3	Tm9v/d	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	As these marker genes were calculated on the initial adult dataset, before adjustments such as the separation of Tm9 cluster into Tm9v/d, these genes differ very slightly from the 587 top10 cluster markers of our final adult dataset.
PMC7790857	Methods; Data Analysis and Statistics; An artificial neural network model to classify single cell transcriptomes	3	5	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We used 200 rectified linear units (ReLU) in the hidden layer and a softmax classification layer corresponding to 193 adult clusters.
PMC7790857	Methods; Data Analysis and Statistics; An artificial neural network model to classify single cell transcriptomes	4	3	cell	FBbt:00004781	wing basal cell 1	C' cell,FBbt:00004781	1.0	We therefore modified this approach to turn on dropout at the classification stage, and calculated 500 independent predictions of classification for each cell in the target dataset using different random subnetworks.
PMC7790857	Methods; Data Analysis and Statistics; Supervised annotation of the P70 dataset	1	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We used this NN model trained on the adult dataset to classify the P70 dataset, the pupal timepoint closest to adult.
PMC7790857	Methods; Data Analysis and Statistics; Supervised annotation of the P70 dataset	1	2	glia	FBbt:00100497	adult glial cell	glia,FBbt:00100497	1.0	P70 cells were classified in general with high confidence (Extended Data Fig8a), with the exception of those that corresponded to LQ clusters, some glia and several cases of biologically meaningful exceptions discussed below.
PMC7790857	Methods; Data Analysis and Statistics; Supervised annotation of the P70 dataset	1	5	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	For each “class” (the annotation predicted by the NN, corresponding to the 193 adult clusters), we calculated the percentage of cells from that class that were placed in the top 5 unsupervised clusters containing the most cells of that class.
PMC7790857	Methods; Data Analysis and Statistics; Supervised annotation of the P70 dataset	1	6	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Similarly, for each unsupervised cluster we calculated the percentage of cells belonging to the 5 most numerous classes.
PMC7790857	Methods; Data Analysis and Statistics; Supervised annotation of the P70 dataset	2	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	After we completed all manual adjustments, we assessed the statistical significance of our divisions using the Seurat v2 function AssessNodes as described for the adult dataset above.
PMC7790857	Methods; Data Analysis and Statistics; Supervised annotation of the P70 dataset	2	3	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Finally, we calculated the P70 top10 cluster markers (642 genes, 445 of them overlapping with the 610 adult top10 markers) to serve as input features for the next iteration of NN training.
PMC7790857	Methods; Benchmarking of the NN classifier; Comparison with Seurat label transfer	1	3	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We thus used FindTransferAnchors and TransferData functions (with default parameters of v3.1) to classify our P70 dataset by using the adult dataset as reference.
PMC7790857	Methods; Benchmarking of the NN classifier; Comparison with Seurat label transfer	2	1	glia	FBbt:00100497	adult glial cell	glia,FBbt:00100497	1.0	Analysis of mismatched classifications between the two methods (Extended Data Fig6d) revealed that the vast majority of disagreements happened within low-quality cells (center of the tSNEs), glia (green circles) or the clusters with no adult correspondence (blue circles), which were predicted with low confidence by both methods.
PMC7790857	Methods; Benchmarking of the NN classifier; Comparison with Seurat label transfer	2	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Analysis of mismatched classifications between the two methods (Extended Data Fig6d) revealed that the vast majority of disagreements happened within low-quality cells (center of the tSNEs), glia (green circles) or the clusters with no adult correspondence (blue circles), which were predicted with low confidence by both methods.
PMC7790857	Methods; Benchmarking of the NN classifier; Comparison with Seurat label transfer	2	2	lower	FBbt:00110191	lower toe of larval mushroom body medial lobe	MAML,FBbt:00110191,MB-MA,axonal side branches,bulbous swelling,lower toe,ma,medial appendix of larval mushroom body	0.8997003436088562	Within the neuronal populations, Seurat was able to restore some lower quality cells (which were largely classified as LQ by the NN) back to their correct classes (based on their unsupervised clustering); however, it also appeared less robust in differentiating between relatively similar cell types.
PMC7790857	Methods; Benchmarking of the NN classifier; Comparison with Seurat label transfer	2	4	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Seurat, however, misclassified 45% of the L1 cells (mostly as L2s) despite the fact that these were correctly placed in the L1 unsupervised cluster and correctly classified as L1s by the NN.
PMC7790857	Methods; Benchmarking of the NN classifier; Comparison with Seurat label transfer	2	5	Dm8s	FBbt:00005909	DM fascicle	DM tract,FBbt:00005909,DMT,M1 fascicle,dorsal medial tract,dorsomedial 1 fascicle,dorsomedial longitudinal tract,dorsomedial tract	1.0	This was observed, to a lesser extent, in the misclassification of some Dm11 cells as Dm8s as well.
PMC7790857	Methods; Benchmarking of the NN classifier; Comparison with Seurat label transfer	2	6	CCA	FBbt:00003216	adult corpus cardiacum	CCA,FBbt:00003216	1.0	Interestingly, Seurat avoided these mistakes when using CCA projections instead of PCA, but this method in turn classified thousands of additional neurons as class 190 (glia/LQ) which again were classified correctly by the NN based on their unsupervised cluster assignments.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	1	2	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	This dataset was generated from whole adult brains and thus included central brain tissue in addition to the optic lobes.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	1	5	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	The only obvious exception to this was Kenyon cells, which were classified with high confidence as class 112, further suggesting that our adult dataset might have included contaminating Kenyon cells.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	2	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Some of these (T2/T3, C2/C3, L4/L5) were already acknowledged by the authors; but we also observed, for instance, Pm1/Pm2 neurons constituted only 11% of the cluster that was annotated as such.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	3	TmY14	FBbt:00111286	transmedullary Y neuron TmY14	TmY14,FBbt:00111286	0.9999998807907104	Clusters annotated as TmY14 (11) and Tm9 (18) were also very heterogenous and in fact did not contain these cell types (Our TmY14 and Tm9 clusters mapped to their unannotated clusters 54 and 63, respectively).
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	3	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Clusters annotated as TmY14 (11) and Tm9 (18) were also very heterogenous and in fact did not contain these cell types (Our TmY14 and Tm9 clusters mapped to their unannotated clusters 54 and 63, respectively).
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	4	Mt1	FBbt:00003837	medullary tangential neuron Mt1	Mt1,FBbt:00003837	1.0	In addition, 3 optic lobe clusters in that study were homogenous but were misannotated: Tm5ab, Mt1 and Dm8/Tm5c clusters were in fact Tm3, Tm4 and Lai, respectively.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	4	Tm3	FBbt:00003791	transmedullary neuron Tm3a	Tm3,FBbt:00003791,Tm3a,transmedullary neuron Tm3	1.0	In addition, 3 optic lobe clusters in that study were homogenous but were misannotated: Tm5ab, Mt1 and Dm8/Tm5c clusters were in fact Tm3, Tm4 and Lai, respectively.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	4	Tm4	FBbt:00003792	transmedullary neuron Tm4	Tm4,FBbt:00003792	0.9999998807907104	In addition, 3 optic lobe clusters in that study were homogenous but were misannotated: Tm5ab, Mt1 and Dm8/Tm5c clusters were in fact Tm3, Tm4 and Lai, respectively.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	4	Lai	FBbt:00003746	lamina intrinsic neuron	Am,FBbt:00003746,Lai,amacrine cell	1.0	In addition, 3 optic lobe clusters in that study were homogenous but were misannotated: Tm5ab, Mt1 and Dm8/Tm5c clusters were in fact Tm3, Tm4 and Lai, respectively.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	5	Dm8	FBbt:00013774	distal medullary amacrine neuron Dm8	Dm8,FBbt:00013774,Dm8a	1.0	Dm8 instead mapped to their unannotated cluster 52, where it had co-clustered with Dm11 and Dm12; Tm5c was in fact part of their cluster 11 mentioned above.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	5	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Dm8 instead mapped to their unannotated cluster 52, where it had co-clustered with Dm11 and Dm12; Tm5c was in fact part of their cluster 11 mentioned above.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	5	Dm11	FBbt:00111272	distal medullary amacrine neuron Dm11	Dm11,FBbt:00111272	1.0	Dm8 instead mapped to their unannotated cluster 52, where it had co-clustered with Dm11 and Dm12; Tm5c was in fact part of their cluster 11 mentioned above.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	5	Dm12	FBbt:00111273	distal medullary amacrine neuron Dm12	Dm12,FBbt:00111273	1.0	Dm8 instead mapped to their unannotated cluster 52, where it had co-clustered with Dm11 and Dm12; Tm5c was in fact part of their cluster 11 mentioned above.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	5	Tm5c	FBbt:00110074	transmedullary neuron Tm5c	Tm5c,FBbt:00110074	1.0	Dm8 instead mapped to their unannotated cluster 52, where it had co-clustered with Dm11 and Dm12; Tm5c was in fact part of their cluster 11 mentioned above.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	8	T2a	FBbt:00003729	T neuron T2a	T2a,FBbt:00003729	0.9999999403953552	Out of these, only 7 were homogenous (>80% of their cluster mapping to a single one of our clusters): T2a, Tm9, Dm9, C2 (the cluster identified as C2/C3 by the authors was mostly just C3) and our unidentified cell types 4, 24 and 26.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	8	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Out of these, only 7 were homogenous (>80% of their cluster mapping to a single one of our clusters): T2a, Tm9, Dm9, C2 (the cluster identified as C2/C3 by the authors was mostly just C3) and our unidentified cell types 4, 24 and 26.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	8	Dm9	FBbt:00005909	DM fascicle	DM tract,FBbt:00005909,DMT,M1 fascicle,dorsal medial tract,dorsomedial 1 fascicle,dorsomedial longitudinal tract,dorsomedial tract	1.0	Out of these, only 7 were homogenous (>80% of their cluster mapping to a single one of our clusters): T2a, Tm9, Dm9, C2 (the cluster identified as C2/C3 by the authors was mostly just C3) and our unidentified cell types 4, 24 and 26.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	8	C2	FBbt:00003743	centrifugal neuron C2	C2,FBbt:00003743	0.9999999403953552	Out of these, only 7 were homogenous (>80% of their cluster mapping to a single one of our clusters): T2a, Tm9, Dm9, C2 (the cluster identified as C2/C3 by the authors was mostly just C3) and our unidentified cell types 4, 24 and 26.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	8	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Out of these, only 7 were homogenous (>80% of their cluster mapping to a single one of our clusters): T2a, Tm9, Dm9, C2 (the cluster identified as C2/C3 by the authors was mostly just C3) and our unidentified cell types 4, 24 and 26.
PMC7790857	Methods; Benchmarking of the NN classifier; Performance in other datasets	2	8	C3	FBbt:00003744	centrifugal neuron C3	C3,FBbt:00003744	1.0	Out of these, only 7 were homogenous (>80% of their cluster mapping to a single one of our clusters): T2a, Tm9, Dm9, C2 (the cluster identified as C2/C3 by the authors was mostly just C3) and our unidentified cell types 4, 24 and 26.
PMC7790857	Methods; Benchmarking of the NN classifier; Multitask extension of the NN classifier	1	1	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	After we completed the annotation of the P70 dataset, we aimed to extend our framework to the earlier pupal stages and annotate all pupal datasets by going backwards through development.
PMC7790857	Methods; Benchmarking of the NN classifier; Multitask extension of the NN classifier	1	6	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	Even at P70 (the largest of the pupal datasets), 100 classes had fewer than 100 cells, and 44 classes had fewer than 50 cells.
PMC7790857	Methods; Benchmarking of the NN classifier; Multitask extension of the NN classifier	2	3	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	P70 and adult for P50 classification), with identical structures except for the input features (i.e. top 10 markers), which were chosen separately for each stage.
PMC7790857	Methods; Benchmarking of the NN classifier; Multitask extension of the NN classifier	2	4	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	The models were trained epoch-by-epoch in an alternating fashion, whereby the weights between ReLU and Softmax layers were copied from one model to another after each epoch (i.e. adult to P70, then P70 to P50, etc.).
PMC7790857	Methods; Benchmarking of the NN classifier; Multitask extension of the NN classifier	2	6	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	It started with two input arms (adult and P70) at the first step.
PMC7790857	Methods; Benchmarking of the NN classifier; Multitask extension of the NN classifier	2	7	proximal	FBbt:00048292	proximal larval optic neuropil	LONp,FBbt:00048292,proximal LON	0.9270682334899902	After training, the P50 dataset was classified using the P70 model, and thus, with P70 markers as the input features, ensuring that the most proximal dataset was the one used directly but the adult dataset still contributed to the training of this model through information leakage at the second layer.
PMC7790857	Methods; Benchmarking of the NN classifier; Multitask extension of the NN classifier	2	7	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	After training, the P50 dataset was classified using the P70 model, and thus, with P70 markers as the input features, ensuring that the most proximal dataset was the one used directly but the adult dataset still contributed to the training of this model through information leakage at the second layer.
PMC7790857	Methods; Benchmarking of the NN classifier; Multitask extension of the NN classifier	2	11	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	A new model combining P50, P70 and adult annotations was then computed and used to annotate the P40 dataset (and so on) until the P15 dataset.
PMC7790857	Methods; Benchmarking of the NN classifier; Multitask extension of the NN classifier	2	12	Lawf1	FBbt:00003741	lamina wide-field 1 neuron	LaWF1,FBbt:00003741,Lawf,Lawf1	1.0	For P15 annotations, the NN model performed poorly on discriminating Lawf1 vs.
PMC7790857	Methods; Benchmarking of the NN classifier; Multitask extension of the NN classifier	2	13	Lawf2	FBbt:00110065	lamina wide-field 2 neuron	Lawf2,FBbt:00110065,Lawfl2	1.0	Lawf2 neurons and also between Tm1/Tm2/Tm4/Cluster 62.
PMC7790857	Methods; Benchmarking of the NN classifier; Multitask extension of the NN classifier	3	2	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	For instance, the multitask model trained on adult, P70, P50 and P40 datasets had achieved 95.9% accuracy on the P40 validation set, compared to the 95.2% accuracy of a model trained on the P40 dataset alone.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	1	1	LC6	FBbt:00003876	lobula columnar neuron LC6	LC06,FBbt:00003876,LC6,S4,lobula columnar neuron Lcn6,lobular columnar neuron Lcn6	1.0	In several cases (clusters 88, 97 (LC6), 169, Dm3, Tm9, T4-5, TE), we were able to find multiple clusters for an identity class in the developmental datasets, even though they were present as a single cluster in adults.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	1	1	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	In several cases (clusters 88, 97 (LC6), 169, Dm3, Tm9, T4-5, TE), we were able to find multiple clusters for an identity class in the developmental datasets, even though they were present as a single cluster in adults.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	1	1	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	In several cases (clusters 88, 97 (LC6), 169, Dm3, Tm9, T4-5, TE), we were able to find multiple clusters for an identity class in the developmental datasets, even though they were present as a single cluster in adults.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	1	1	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	In several cases (clusters 88, 97 (LC6), 169, Dm3, Tm9, T4-5, TE), we were able to find multiple clusters for an identity class in the developmental datasets, even though they were present as a single cluster in adults.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	1	1	adults	FBbt:00003004	adult	imago,FBbt:00003004	0.8939151167869568	In several cases (clusters 88, 97 (LC6), 169, Dm3, Tm9, T4-5, TE), we were able to find multiple clusters for an identity class in the developmental datasets, even though they were present as a single cluster in adults.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	1	6	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	If multiple steps were necessary to reach the adult dataset, we employed a multitask scheme as described above for the general classifier.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	1	7	LC6	FBbt:00003876	lobula columnar neuron LC6	LC06,FBbt:00003876,LC6,S4,lobula columnar neuron Lcn6,lobular columnar neuron Lcn6	1.0	This was done for classes 97 (LC6), 220 (TE cells, only from P50 to P70), 35 (Dm3), 121 (Tm9), 88 and 169.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	1	7	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	This was done for classes 97 (LC6), 220 (TE cells, only from P50 to P70), 35 (Dm3), 121 (Tm9), 88 and 169.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	1	8	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	Note that even though Dm3 and Tm9 NNs were able to divide the corresponding clusters at P70 and adult into subtypes, these divisions were highly unreliable (OOBE P70/Adult: 27%/32% for Dm3 and 23%/22% for Tm9).
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	1	8	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Note that even though Dm3 and Tm9 NNs were able to divide the corresponding clusters at P70 and adult into subtypes, these divisions were highly unreliable (OOBE P70/Adult: 27%/32% for Dm3 and 23%/22% for Tm9).
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	1	8	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Note that even though Dm3 and Tm9 NNs were able to divide the corresponding clusters at P70 and adult into subtypes, these divisions were highly unreliable (OOBE P70/Adult: 27%/32% for Dm3 and 23%/22% for Tm9).
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	1	10	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	The rest of the divisions could be reliably carried back to the adult stage.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	2	1	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	In addition, we subclustered TE neurons at all pupal stages using 20 PCs and 0.5 resolution to search for any additional subtypes.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	2	2	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	In all stages, we identified a small number of cells that did not express several markers of TE neurons (Wnt4, Wnt10, Fs, dimm) but expressed Imp, which is not expressed in the rest of the TE cluster.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	2	2	Wnt4	FBbt:00003160	adult heart chamber 4	Ht4,FBbt:00003160,chamber 4,terminal cardiac chamber	1.0	In all stages, we identified a small number of cells that did not express several markers of TE neurons (Wnt4, Wnt10, Fs, dimm) but expressed Imp, which is not expressed in the rest of the TE cluster.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	2	2	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	In all stages, we identified a small number of cells that did not express several markers of TE neurons (Wnt4, Wnt10, Fs, dimm) but expressed Imp, which is not expressed in the rest of the TE cluster.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	2	3	peptidergic neurons	FBbt:00004101	peptidergic neuron	peptinergic neuron,FBbt:00004101	0.8755197525024414	These likely represented rare peptidergic neurons clustering with TE neurons due to their unique properties.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	2	3	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	These likely represented rare peptidergic neurons clustering with TE neurons due to their unique properties.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	2	4	plots	FBbt:00007083	adult posterior lateral fascicle	PLF,FBbt:00007083,p l fasc	1.0	Thus, we filtered out the subcluster containing these cells at each stage before generating the UMAP plots of Fig 2a.
PMC7790857	Methods; Benchmarking of the NN classifier; Backprojection of the developmental splits	3	1	adults	FBbt:00003004	adult	imago,FBbt:00003004	0.8939151167869568	T4-T5 neurons (class 130), that each consist of 4 subtypes, also presented as a single cluster in adults and were subdivided in several unsupervised clusters for all developmental datasets, albeit inconsistently.
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	1	T4	FBbt:00003731	T neuron T4	T4,FBbt:00003731	1.0	Even though the subtype divisions of T4 and T5 neurons are well characterized both functionally and developmentally [42], the unsupervised divisions within this cluster in the adult dataset were largely based on technical variation (Extended Data Fig1f) and were merged.
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	1	T5	FBbt:00003736	T neuron T5	T5,FBbt:00003736	1.0	Even though the subtype divisions of T4 and T5 neurons are well characterized both functionally and developmentally [42], the unsupervised divisions within this cluster in the adult dataset were largely based on technical variation (Extended Data Fig1f) and were merged.
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	1	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Even though the subtype divisions of T4 and T5 neurons are well characterized both functionally and developmentally [42], the unsupervised divisions within this cluster in the adult dataset were largely based on technical variation (Extended Data Fig1f) and were merged.
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Even though the subtype divisions of T4 and T5 neurons are well characterized both functionally and developmentally [42], the unsupervised divisions within this cluster in the adult dataset were largely based on technical variation (Extended Data Fig1f) and were merged.
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	3	klg	FBbt:00001247	basal procephalic longitudinal glia cluster	BPLG,FBbt:00001247	1.0	We thus isolated them at this stage and performed subclustering (resolution=1) using 8 hand-picked principle components whose top 10 feature loadings (positive or negative) included genes that were known markers of their subtypes [51] (klg, bi, lea, Con, TfAP-2, grn, dpr10).
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	3	lea	FBbt:00049273	adult anterior lateral ellipsoid fascicle	LEa,FBbt:00049273	1.0	We thus isolated them at this stage and performed subclustering (resolution=1) using 8 hand-picked principle components whose top 10 feature loadings (positive or negative) included genes that were known markers of their subtypes [51] (klg, bi, lea, Con, TfAP-2, grn, dpr10).
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	3	grn	FBbt:00005927	gustatory receptor neuron	GRN,FBbt:00005927,GSN,gustatory sensory neuron	1.0	We thus isolated them at this stage and performed subclustering (resolution=1) using 8 hand-picked principle components whose top 10 feature loadings (positive or negative) included genes that were known markers of their subtypes [51] (klg, bi, lea, Con, TfAP-2, grn, dpr10).
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	5	T4	FBbt:00003731	T neuron T4	T4,FBbt:00003731	1.0	As it was also recently reported by others [51], we could observe that all T4-T5 subtypes can be defined by three distinct axes of division: T4 vs.
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	8	ICs	FBbt:00048278	wing campaniform sensillum	Wcs,FBbt:00048278,wing sensillum campaniformium	1.0	At each stage, we identified three ICs defined by the above axes and clustered T4-T5 neurons based exclusively on those.
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	10	Adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	P15 and Adult datasets were particularly difficult, in both cases the IC that defines b/c vs. a/d division (grn) was ranked particularly low (16^th and 17^th, respectively), resulting in very large errors over this axis.
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	10	IC	FBbt:00048549	larval intermingled cell	IC,FBbt:00048549,larval interstitial cell	1.0	P15 and Adult datasets were particularly difficult, in both cases the IC that defines b/c vs. a/d division (grn) was ranked particularly low (16^th and 17^th, respectively), resulting in very large errors over this axis.
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	10	grn	FBbt:00005927	gustatory receptor neuron	GRN,FBbt:00005927,GSN,gustatory sensory neuron	1.0	P15 and Adult datasets were particularly difficult, in both cases the IC that defines b/c vs. a/d division (grn) was ranked particularly low (16^th and 17^th, respectively), resulting in very large errors over this axis.
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	11	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	We then built cluster trees for all stages and report below the OOBE values calculated for some terminal nodes.
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	11	terminal	FBbt:00005112	nerve terminal	terminal,FBbt:00005112	1.0	We then built cluster trees for all stages and report below the OOBE values calculated for some terminal nodes.
PMC7790857	Methods; Benchmarking of the NN classifier; Subclustering of T4-T5 neurons	1	12	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Note that 50% OOBE would imply a completely random division and we usually require less than 5% (adult) or 10% (pupae, due to lower size datasets) OOBE to consider a division reliable, and consider any division with >20% OOBE as essentially unusable.
PMC7790857	Methods; Benchmarking of the NN classifier; Adult	1	1	terminal	FBbt:00005112	nerve terminal	terminal,FBbt:00005112	1.0	All terminal nodes corresponding to T4 vs.
PMC7790857	Methods; Benchmarking of the NN classifier; Adult	1	1	T4	FBbt:00003731	T neuron T4	T4,FBbt:00003731	1.0	All terminal nodes corresponding to T4 vs.
PMC7790857	Methods; Benchmarking of the NN classifier; P70	1	3	Terminal	FBbt:00005112	nerve terminal	terminal,FBbt:00005112	1.0	Terminal divisions T4c vs.
PMC7790857	Methods; Benchmarking of the NN classifier; P70	1	4	T5c	FBbt:00003739	T neuron T5c	T5c,FBbt:00003739	1.0	T5c and T4b vs.
PMC7790857	Methods; Benchmarking of the NN classifier; P70	1	4	T4b	FBbt:00003733	T neuron T4b	T4b,FBbt:00003733	1.0	T5c and T4b vs.
PMC7790857	Methods; Benchmarking of the NN classifier; P70	1	5	T5b	FBbt:00003738	T neuron T5b	T5b,FBbt:00003738	0.9999999403953552	T5b had OOBEs of 24% and 16%.
PMC7790857	Methods; Benchmarking of the NN classifier; P40	1	1	T4c	FBbt:00003734	T neuron T4c	T4c,FBbt:00003734	1.0	Most subtypes could be reliably resolved except for T4c vs.
PMC7790857	Methods; Benchmarking of the NN classifier; P40	1	2	T4d	FBbt:00003735	T neuron T4d	T4d,FBbt:00003735	1.0	T4d and T5c vs.
PMC7790857	Methods; Benchmarking of the NN classifier; P40	1	2	T5c	FBbt:00003739	T neuron T5c	T5c,FBbt:00003739	1.0	T4d and T5c vs.
PMC7790857	Methods; Benchmarking of the NN classifier; P30	1	2	T4	FBbt:00003731	T neuron T4	T4,FBbt:00003731	1.0	T4 vs.
PMC7790857	Methods; Benchmarking of the NN classifier; P30	1	3	T4c	FBbt:00003734	T neuron T4c	T4c,FBbt:00003734	1.0	T5 divisions all had OOBE >10%, largest being T4c vs.
PMC7790857	Methods; Benchmarking of the NN classifier; P15	1	1	T4	FBbt:00003731	T neuron T4	T4,FBbt:00003731	1.0	a/b vs. c/d division was reliable with OOBE of 5%. a/d vs. c/b and T4 vs.
PMC7790857	Methods; Benchmarking of the NN classifier; Stable transcription factor markers in neuronal clusters	1	2	photoreceptors	FBbt:00004211	photoreceptor neuron	photoreceptor cell,FBbt:00004211,receptor cell	0.9045262336730957	To determine neuron-specific markers (to eliminate pan-neuronal genes), we isolated 175 neuronal clusters (including the backprojected developmental splits described above, excluding the photoreceptors) and re-calculated the clusters markers at each stage.
PMC7790857	Methods; Benchmarking of the NN classifier; Stable transcription factor markers in neuronal clusters	2	2	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Next, we determined for each cluster which TFs were consistently significant markers between stages.
PMC7790857	Methods; Benchmarking of the NN classifier; Stable transcription factor markers in neuronal clusters	2	3	lower	FBbt:00110191	lower toe of larval mushroom body medial lobe	MAML,FBbt:00110191,MB-MA,axonal side branches,bulbous swelling,lower toe,ma,medial appendix of larval mushroom body	0.8997003436088562	Since some markers for smaller clusters may be randomly dropped out due to lower sample sizes in pupal stages and at P15 some clusters have not fully acquired their identity, we allowed some flexibility: We took the TFs that were markers for each cluster in the adult dataset and at least four out of the five pupal datasets.
PMC7790857	Methods; Benchmarking of the NN classifier; Stable transcription factor markers in neuronal clusters	2	3	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	Since some markers for smaller clusters may be randomly dropped out due to lower sample sizes in pupal stages and at P15 some clusters have not fully acquired their identity, we allowed some flexibility: We took the TFs that were markers for each cluster in the adult dataset and at least four out of the five pupal datasets.
PMC7790857	Methods; Benchmarking of the NN classifier; Stable transcription factor markers in neuronal clusters	2	3	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Since some markers for smaller clusters may be randomly dropped out due to lower sample sizes in pupal stages and at P15 some clusters have not fully acquired their identity, we allowed some flexibility: We took the TFs that were markers for each cluster in the adult dataset and at least four out of the five pupal datasets.
PMC7790857	Methods; Benchmarking of the NN classifier; Stable transcription factor markers in neuronal clusters	2	3	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Since some markers for smaller clusters may be randomly dropped out due to lower sample sizes in pupal stages and at P15 some clusters have not fully acquired their identity, we allowed some flexibility: We took the TFs that were markers for each cluster in the adult dataset and at least four out of the five pupal datasets.
PMC7790857	Methods; Benchmarking of the NN classifier; Stable transcription factor markers in neuronal clusters	2	5	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Table 2) were unique to each cluster, with only the exception of Tm9v/d subtypes.
PMC7790857	Methods; Benchmarking of the NN classifier; Stable transcription factor markers in neuronal clusters	2	5	Tm9v/d	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Table 2) were unique to each cluster, with only the exception of Tm9v/d subtypes.
PMC7790857	Methods; Benchmarking of the NN classifier; Stable transcription factor markers in neuronal clusters	2	6	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	The median number of TFs in each cluster is 8, the minimum per cluster is 2 and maximum is 13 TFs for a cluster.
PMC7790857	Methods; Benchmarking of the NN classifier; GO enrichment analysis of the markers	1	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	In order to determine the genes that were differentially expressed across different stages, we subsetted all objects (from P15 to adult) to contain only neuronal clusters.
PMC7790857	Methods; Benchmarking of the NN classifier; GO enrichment analysis of the markers	1	4	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	The number of significant markers for each stage ranged from 193 in P40 to 746 in adult.
PMC7790857	Methods; Benchmarking of the NN classifier; GO enrichment analysis of the markers	1	6	logFC	FBbt:00000533	mesothoracic lateral oblique muscle cell	LO,FBbt:00000533	1.0	We included only the top 20 markers (by logFC) for each cluster in order to have a similar number of genes per stage as the stage markers. 332 of these markers genes (about half the total at each stage) were shared between all pupal and adult stages, and as a result, GO terms largely overlapped as well (Extended Data Fig11a).
PMC7790857	Methods; Benchmarking of the NN classifier; GO enrichment analysis of the markers	1	6	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	We included only the top 20 markers (by logFC) for each cluster in order to have a similar number of genes per stage as the stage markers. 332 of these markers genes (about half the total at each stage) were shared between all pupal and adult stages, and as a result, GO terms largely overlapped as well (Extended Data Fig11a).
PMC7790857	Methods; Benchmarking of the NN classifier; GO enrichment analysis of the markers	1	6	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	We included only the top 20 markers (by logFC) for each cluster in order to have a similar number of genes per stage as the stage markers. 332 of these markers genes (about half the total at each stage) were shared between all pupal and adult stages, and as a result, GO terms largely overlapped as well (Extended Data Fig11a).
PMC7790857	Methods; Benchmarking of the NN classifier; GO enrichment analysis of the markers	1	6	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	We included only the top 20 markers (by logFC) for each cluster in order to have a similar number of genes per stage as the stage markers. 332 of these markers genes (about half the total at each stage) were shared between all pupal and adult stages, and as a result, GO terms largely overlapped as well (Extended Data Fig11a).
PMC7790857	Methods; Connectome Analysis	1	2	Dm3 cell	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	0.8533020615577698	Due to very elongated nature of Dm3 arbors, 2D projection and plotting of these coordinates for each Dm3 cell readily revealed its directionality.
PMC7790857	Methods; Connectome Analysis	1	3	synaptic	FBbt:00005815	dense body	NMJ synaptic ribbon,FBbt:00005815	0.9042073488235474	We thus plotted the synaptic coordinates of all Dm3 neurons together, each individual cell colored differently, to identify the two subtypes with orthogonal orientations.
PMC7790857	Methods; Connectome Analysis	1	3	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	We thus plotted the synaptic coordinates of all Dm3 neurons together, each individual cell colored differently, to identify the two subtypes with orthogonal orientations.
PMC7790857	Methods; Connectome Analysis	2	1	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	We then calculated the values of normalized inputs/outputs to/from particular cell types for each Dm3 and compared their averages between the two subtypes, excluding the cells with less than 20 total input or outputs in each case.
PMC7790857	Methods; Connectome Analysis	2	3	Dm3 neuron	FBbt:00110334	larval dopaminergic DM3 neuron	DM3 neuron,FBbt:00110334	1.0	In each case the number of synapses to/from a specific neuronal identity (pooled total of all cells belonging to that type) was divided by the total number of input/output synapses of that Dm3 neuron.
PMC7790857	Methods; Connectome Analysis	2	4	plots	FBbt:00007083	adult posterior lateral fascicle	PLF,FBbt:00007083,p l fasc	1.0	As we did not see clear differences in the average normalized inputs between subtypes (besides the synapses between Dm3s), Figure 4d only plots the average normalized outputs to the postsynaptic cell types where we identified differences.
PMC7790857	figure	Extended Data Figure 1:	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Batch effect removal and biological significance of the adult clusters a.
PMC7790857	figure	Extended Data Figure 1:	2	right	FBbt:00051240	right asymmetrical body	AB(R),FBbt:00051240,right AB	0.8630387187004089	The proportions of UMIs from mitochondrial genes per cell (n = number of cells in each library, indicated on the right) and the total number of cells passing filters in each of the 15 libraries comprising the adult dataset.
PMC7790857	figure	Extended Data Figure 1:	2	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	The proportions of UMIs from mitochondrial genes per cell (n = number of cells in each library, indicated on the right) and the total number of cells passing filters in each of the 15 libraries comprising the adult dataset.
PMC7790857	figure	Extended Data Figure 1:	3	Adult.rds	FBbt:00003004	adult	imago,FBbt:00003004	0.8939151167869568	Names indicated correspond to the names in the Seurat object provided (Adult.rds, GSE142787).
PMC7790857	figure	Extended Data Figure 1:	5	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Whiskers extend from the box to the highest or lowest values in the 1.5 inter-quartile range, and outlying datapoints are represented by a dot. b, Origin of the cells in the final adult clusters, colored as in (a).
PMC7790857	figure	Extended Data Figure 1:	6	cluster 3	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	0.9242535829544067	Green arrows: clusters whose unique library distribution can be explained by variable contamination from surrounding tissues (cluster 3 is photoreceptors, 112 is likely Kenyon Cells from the central brain) or the number of lamina neuropils dissociated (clusters 107, 108, 109 are lamina neurons).
PMC7790857	figure	Extended Data Figure 1:	6	photoreceptors	FBbt:00004211	photoreceptor neuron	photoreceptor cell,FBbt:00004211,receptor cell	0.9045262336730957	Green arrows: clusters whose unique library distribution can be explained by variable contamination from surrounding tissues (cluster 3 is photoreceptors, 112 is likely Kenyon Cells from the central brain) or the number of lamina neuropils dissociated (clusters 107, 108, 109 are lamina neurons).
PMC7790857	figure	Extended Data Figure 1:	6	central brain	FBbt:00047887	adult central brain	midbrain,FBbt:00047887	0.949384868144989	Green arrows: clusters whose unique library distribution can be explained by variable contamination from surrounding tissues (cluster 3 is photoreceptors, 112 is likely Kenyon Cells from the central brain) or the number of lamina neuropils dissociated (clusters 107, 108, 109 are lamina neurons).
PMC7790857	figure	Extended Data Figure 1:	10	Right	FBbt:00051240	right asymmetrical body	AB(R),FBbt:00051240,right AB	0.8630387187004089	Right: Number of isolated neuronal type transcriptomes matching to 1–5 of our adult clusters, for each pair of parameters in (c), which we used as a measure of the biological relevance of our clusters.
PMC7790857	figure	Extended Data Figure 1:	10	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Right: Number of isolated neuronal type transcriptomes matching to 1–5 of our adult clusters, for each pair of parameters in (c), which we used as a measure of the biological relevance of our clusters.
PMC7790857	figure	Extended Data Figure 1:	14	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Cell colors indicate the cluster they belonged to before we merged artificially split clusters (red circles, Methods). f, Heatmap showing scaled log-normalized non-integrated expression of the top20 cluster markers between the merged clusters.
PMC7790857	figure	Extended Data Figure 2:	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Identification of neuronal and glial clusters. a, Pearson correlation between the average log-normalized non-integrated expression of the top10 cluster markers of the adult dataset clusters (x-axis) and the transcriptome of isolated Repo+ (glial marker) or Elav+ (neuronal marker) populations.
PMC7790857	figure	Extended Data Figure 2:	2	lower	FBbt:00110191	lower toe of larval mushroom body medial lobe	MAML,FBbt:00110191,MB-MA,axonal side branches,bulbous swelling,lower toe,ma,medial appendix of larval mushroom body	0.8997003436088562	LQ = clusters containing a proportion of cells with features of lower quality transcriptomes. b, Violin plots of features tending to be higher (proportions of UMI from mitochondrial genes) or lower (number of UMIs or genes per cell) in low quality cells 47,48. c, Heatmap showing the scaled log-normalized non-integrated expression of the top5 cluster markers of the adult dataset.
PMC7790857	figure	Extended Data Figure 2:	2	plots	FBbt:00007083	adult posterior lateral fascicle	PLF,FBbt:00007083,p l fasc	1.0	LQ = clusters containing a proportion of cells with features of lower quality transcriptomes. b, Violin plots of features tending to be higher (proportions of UMI from mitochondrial genes) or lower (number of UMIs or genes per cell) in low quality cells 47,48. c, Heatmap showing the scaled log-normalized non-integrated expression of the top5 cluster markers of the adult dataset.
PMC7790857	figure	Extended Data Figure 2:	2	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	LQ = clusters containing a proportion of cells with features of lower quality transcriptomes. b, Violin plots of features tending to be higher (proportions of UMI from mitochondrial genes) or lower (number of UMIs or genes per cell) in low quality cells 47,48. c, Heatmap showing the scaled log-normalized non-integrated expression of the top5 cluster markers of the adult dataset.
PMC7790857	figure	Extended Data Figure 2:	3	cluster 1	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	0.9317575693130493	The first 5 neuronal adult clusters (1 to 6, cluster 1 and 2 having been merged) are plotted for reference as they clearly have specific gene expression patterns.
PMC7790857	figure	Extended Data Figure 2:	6	Cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Cluster 191 expresses several markers found in no other clusters and likely correspond to neither glia nor optic-lobe neuron.
PMC7790857	figure	Extended Data Figure 2:	6	glia	FBbt:00100497	adult glial cell	glia,FBbt:00100497	1.0	Cluster 191 expresses several markers found in no other clusters and likely correspond to neither glia nor optic-lobe neuron.
PMC7790857	figure	Extended Data Figure 2:	7	Cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Cluster 192 expresses mainly low levels of glia-specific genes, without specific markers.
PMC7790857	figure	Extended Data Figure 3:	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Identification of the adult neuronal clusters. a, Pearson correlation between the average log-normalized non-integrated expression of the top10 cluster markers of the adult dataset clusters (x-axis) and the transcriptome of isolated neurons18,20.
PMC7790857	figure	Extended Data Figure 3:	2	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	We represented Dm3, Tm9, T4 and T5 before their split into Dm3a/b, Tm9v/d, T4/T5ab and T4/T5cd.
PMC7790857	figure	Extended Data Figure 3:	2	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	We represented Dm3, Tm9, T4 and T5 before their split into Dm3a/b, Tm9v/d, T4/T5ab and T4/T5cd.
PMC7790857	figure	Extended Data Figure 3:	2	T4	FBbt:00003731	T neuron T4	T4,FBbt:00003731	1.0	We represented Dm3, Tm9, T4 and T5 before their split into Dm3a/b, Tm9v/d, T4/T5ab and T4/T5cd.
PMC7790857	figure	Extended Data Figure 3:	2	T5	FBbt:00003736	T neuron T5	T5,FBbt:00003736	1.0	We represented Dm3, Tm9, T4 and T5 before their split into Dm3a/b, Tm9v/d, T4/T5ab and T4/T5cd.
PMC7790857	figure	Extended Data Figure 3:	2	Tm9v/d	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	We represented Dm3, Tm9, T4 and T5 before their split into Dm3a/b, Tm9v/d, T4/T5ab and T4/T5cd.
PMC7790857	figure	Extended Data Figure 3:	5	KC	FBbt:00003686	Kenyon cell	KC,FBbt:00003686,MB neuron,intrinsic cell of mushroom body,intrinsic neuron of mushroom body,mature Kenyon cell,mushroom body neuron	1.0	KC: Kenyon Cells, cluster 112 therefore likely corresponds to contamination from the central brain. b, Legend as in (a).
PMC7790857	figure	Extended Data Figure 3:	5	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	KC: Kenyon Cells, cluster 112 therefore likely corresponds to contamination from the central brain. b, Legend as in (a).
PMC7790857	figure	Extended Data Figure 3:	5	central brain	FBbt:00047887	adult central brain	midbrain,FBbt:00047887	0.949384868144989	KC: Kenyon Cells, cluster 112 therefore likely corresponds to contamination from the central brain. b, Legend as in (a).
PMC7790857	figure	Extended Data Figure 3:	6	lower	FBbt:00110191	lower toe of larval mushroom body medial lobe	MAML,FBbt:00110191,MB-MA,axonal side branches,bulbous swelling,lower toe,ma,medial appendix of larval mushroom body	0.8997003436088562	We indicated several matching clusters to highlight the high similarity between LC cells transcriptomes, which explains the lower correlation gaps observed for these neurons. c, Left: Legend as in (a).
PMC7790857	figure	Extended Data Figure 3:	7	Right	FBbt:00051240	right asymmetrical body	AB(R),FBbt:00051240,right AB	0.8630387187004089	Right: mixture modelling of Pm3 markers19 (y axis).
PMC7790857	figure	Extended Data Figure 4:	1	TmY4	FBbt:00003817	transmedullary Y neuron	TmY,FBbt:00003817	1.0	Marker gene expressions in TmY4, TmY8, TmY14, LC12 and LC17 neurons. a, Expression pattern of TmY4-LexA (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (white).
PMC7790857	figure	Extended Data Figure 4:	1	TmY8	FBbt:00003817	transmedullary Y neuron	TmY,FBbt:00003817	1.0	Marker gene expressions in TmY4, TmY8, TmY14, LC12 and LC17 neurons. a, Expression pattern of TmY4-LexA (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (white).
PMC7790857	figure	Extended Data Figure 4:	1	TmY14	FBbt:00111286	transmedullary Y neuron TmY14	TmY14,FBbt:00111286	0.9999998807907104	Marker gene expressions in TmY4, TmY8, TmY14, LC12 and LC17 neurons. a, Expression pattern of TmY4-LexA (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (white).
PMC7790857	figure	Extended Data Figure 4:	1	LC12	FBbt:00100484	lobula columnar neuron LC12	LC12,FBbt:00100484,Lcn12	0.9999998807907104	Marker gene expressions in TmY4, TmY8, TmY14, LC12 and LC17 neurons. a, Expression pattern of TmY4-LexA (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (white).
PMC7790857	figure	Extended Data Figure 4:	1	LC17	FBbt:00111752	lobula columnar neuron LC17	LC17,FBbt:00111752	1.0	Marker gene expressions in TmY4, TmY8, TmY14, LC12 and LC17 neurons. a, Expression pattern of TmY4-LexA (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (white).
PMC7790857	figure	Extended Data Figure 4:	1	adult optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	1.0	Marker gene expressions in TmY4, TmY8, TmY14, LC12 and LC17 neurons. a, Expression pattern of TmY4-LexA (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (white).
PMC7790857	figure	Extended Data Figure 4:	2	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	The LexA line shows weak or no expression in the most anterior medulla region. b-d, Expression pattern of TmY4-LexA (green) in the adult optic lobe with anti-Dichaete (D) (b), anti-Vvl (c) and anti-Toy (d) immunostainings (magenta), n=15 neurons for each.
PMC7790857	figure	Extended Data Figure 4:	2	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	The LexA line shows weak or no expression in the most anterior medulla region. b-d, Expression pattern of TmY4-LexA (green) in the adult optic lobe with anti-Dichaete (D) (b), anti-Vvl (c) and anti-Toy (d) immunostainings (magenta), n=15 neurons for each.
PMC7790857	figure	Extended Data Figure 4:	3	TmY4	FBbt:00003817	transmedullary Y neuron	TmY,FBbt:00003817	1.0	TmY4 cell bodies express Dichaete but not Vvl or Toy. e, Sparse labeling of cell types (anti-FLAG, green) expressing CG42548 in the adult optic lobe using MCFO and immunostained with anti-Brp (white) and anti-Vvl (magenta).
PMC7790857	figure	Extended Data Figure 4:	3	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	TmY4 cell bodies express Dichaete but not Vvl or Toy. e, Sparse labeling of cell types (anti-FLAG, green) expressing CG42548 in the adult optic lobe using MCFO and immunostained with anti-Brp (white) and anti-Vvl (magenta).
PMC7790857	figure	Extended Data Figure 4:	3	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	TmY4 cell bodies express Dichaete but not Vvl or Toy. e, Sparse labeling of cell types (anti-FLAG, green) expressing CG42548 in the adult optic lobe using MCFO and immunostained with anti-Brp (white) and anti-Vvl (magenta).
PMC7790857	figure	Extended Data Figure 4:	3	MCFO	FBbt:00001631	medial cervical tract	MCT,FBbt:00001631	0.8614316582679749	TmY4 cell bodies express Dichaete but not Vvl or Toy. e, Sparse labeling of cell types (anti-FLAG, green) expressing CG42548 in the adult optic lobe using MCFO and immunostained with anti-Brp (white) and anti-Vvl (magenta).
PMC7790857	figure	Extended Data Figure 4:	4	TmY8	FBbt:00003817	transmedullary Y neuron	TmY,FBbt:00003817	1.0	A TmY8 neuron (n=4 neurons) is labeled (arborized layers shown by arrows) and expresses Vvl.
PMC7790857	figure	Extended Data Figure 4:	4	neuron	FBbt:00001564	U neuron	U motor neuron,FBbt:00001564,U/CQ neuron	1.0	A TmY8 neuron (n=4 neurons) is labeled (arborized layers shown by arrows) and expresses Vvl.
PMC7790857	figure	Extended Data Figure 4:	5	Adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Adult flies were heat-shocked for 5 minutes and dissected after 6 days. f-h, Expression pattern of R24F10-Gal4 (green) in late L3 optic lobes with anti-NCad (white, f), anti-Dac (magenta, f), anti-Dichaete (magenta, g) and anti-Toy (magenta, h) immunostainings, n=15 neurons for each.
PMC7790857	figure	Extended Data Figure 4:	6	TmY14	FBbt:00111286	transmedullary Y neuron TmY14	TmY14,FBbt:00111286	0.9999998807907104	R24F10-Gal4 is expressed in TmY14 neurons during larval stage (unpublished data).
PMC7790857	figure	Extended Data Figure 4:	7	TmY14	FBbt:00111286	transmedullary Y neuron TmY14	TmY14,FBbt:00111286	0.9999998807907104	TmY14 neurons express Toy (h) but not Dac or D (f-g). i, Expression pattern of LC12-Gal4 (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (magenta) showing processes in lobula layers 2–4, and a projection to an optic glomerulus in the posterior ventrolateral protocerebrum (PVLP) of the central brain (white outline).
PMC7790857	figure	Extended Data Figure 4:	7	D	FBbt:00048431	adult abdominal dorsal multidendritic neuron ddaC	D neuron,FBbt:00048431	0.8554139137268066	TmY14 neurons express Toy (h) but not Dac or D (f-g). i, Expression pattern of LC12-Gal4 (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (magenta) showing processes in lobula layers 2–4, and a projection to an optic glomerulus in the posterior ventrolateral protocerebrum (PVLP) of the central brain (white outline).
PMC7790857	figure	Extended Data Figure 4:	7	adult optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	1.0	TmY14 neurons express Toy (h) but not Dac or D (f-g). i, Expression pattern of LC12-Gal4 (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (magenta) showing processes in lobula layers 2–4, and a projection to an optic glomerulus in the posterior ventrolateral protocerebrum (PVLP) of the central brain (white outline).
PMC7790857	figure	Extended Data Figure 4:	7	projection	FBbt:00007392	projection neuron	PN,FBbt:00007392	0.9511634111404419	TmY14 neurons express Toy (h) but not Dac or D (f-g). i, Expression pattern of LC12-Gal4 (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (magenta) showing processes in lobula layers 2–4, and a projection to an optic glomerulus in the posterior ventrolateral protocerebrum (PVLP) of the central brain (white outline).
PMC7790857	figure	Extended Data Figure 4:	7	optic glomerulus	FBbt:00003698	optic glomerulus	optic focus,FBbt:00003698	1.0	TmY14 neurons express Toy (h) but not Dac or D (f-g). i, Expression pattern of LC12-Gal4 (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (magenta) showing processes in lobula layers 2–4, and a projection to an optic glomerulus in the posterior ventrolateral protocerebrum (PVLP) of the central brain (white outline).
PMC7790857	figure	Extended Data Figure 4:	7	posterior ventrolateral protocerebrum	FBbt:00040042	posterior ventrolateral protocerebrum	PVLP,FBbt:00040042,posterior VLP	1.0	TmY14 neurons express Toy (h) but not Dac or D (f-g). i, Expression pattern of LC12-Gal4 (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (magenta) showing processes in lobula layers 2–4, and a projection to an optic glomerulus in the posterior ventrolateral protocerebrum (PVLP) of the central brain (white outline).
PMC7790857	figure	Extended Data Figure 4:	7	PVLP	FBbt:00040042	posterior ventrolateral protocerebrum	PVLP,FBbt:00040042,posterior VLP	1.0	TmY14 neurons express Toy (h) but not Dac or D (f-g). i, Expression pattern of LC12-Gal4 (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (magenta) showing processes in lobula layers 2–4, and a projection to an optic glomerulus in the posterior ventrolateral protocerebrum (PVLP) of the central brain (white outline).
PMC7790857	figure	Extended Data Figure 4:	7	central brain	FBbt:00047887	adult central brain	midbrain,FBbt:00047887	0.949384868144989	TmY14 neurons express Toy (h) but not Dac or D (f-g). i, Expression pattern of LC12-Gal4 (green) in the adult optic lobe (n=7 brains) with anti-NCad immunostaining (magenta) showing processes in lobula layers 2–4, and a projection to an optic glomerulus in the posterior ventrolateral protocerebrum (PVLP) of the central brain (white outline).
PMC7790857	figure	Extended Data Figure 4:	8	LC12	FBbt:00100484	lobula columnar neuron LC12	LC12,FBbt:00100484,Lcn12	0.9999998807907104	The cell bodies of LC12 are located in the lateral cell body rind, the region separating the optic lobe and central brain. j, Expression pattern of beat-Ic (green) in the adult optic lobe (n=6 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC12 in the PVLP (white outline). k-m.
PMC7790857	figure	Extended Data Figure 4:	8	lateral cell body	FBbt:00001302	lateral cell body glial cell	L-CBG,FBbt:00001302,lateral CBG,lateral cortex glial cell,lateral cortex-associated glial cell,longitudinal cell body glial cell	0.8522955775260925	The cell bodies of LC12 are located in the lateral cell body rind, the region separating the optic lobe and central brain. j, Expression pattern of beat-Ic (green) in the adult optic lobe (n=6 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC12 in the PVLP (white outline). k-m.
PMC7790857	figure	Extended Data Figure 4:	8	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	The cell bodies of LC12 are located in the lateral cell body rind, the region separating the optic lobe and central brain. j, Expression pattern of beat-Ic (green) in the adult optic lobe (n=6 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC12 in the PVLP (white outline). k-m.
PMC7790857	figure	Extended Data Figure 4:	8	central brain	FBbt:00047887	adult central brain	midbrain,FBbt:00047887	0.949384868144989	The cell bodies of LC12 are located in the lateral cell body rind, the region separating the optic lobe and central brain. j, Expression pattern of beat-Ic (green) in the adult optic lobe (n=6 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC12 in the PVLP (white outline). k-m.
PMC7790857	figure	Extended Data Figure 4:	8	adult optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	1.0	The cell bodies of LC12 are located in the lateral cell body rind, the region separating the optic lobe and central brain. j, Expression pattern of beat-Ic (green) in the adult optic lobe (n=6 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC12 in the PVLP (white outline). k-m.
PMC7790857	figure	Extended Data Figure 4:	8	optic glomerulus	FBbt:00003698	optic glomerulus	optic focus,FBbt:00003698	1.0	The cell bodies of LC12 are located in the lateral cell body rind, the region separating the optic lobe and central brain. j, Expression pattern of beat-Ic (green) in the adult optic lobe (n=6 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC12 in the PVLP (white outline). k-m.
PMC7790857	figure	Extended Data Figure 4:	8	PVLP	FBbt:00040042	posterior ventrolateral protocerebrum	PVLP,FBbt:00040042,posterior VLP	1.0	The cell bodies of LC12 are located in the lateral cell body rind, the region separating the optic lobe and central brain. j, Expression pattern of beat-Ic (green) in the adult optic lobe (n=6 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC12 in the PVLP (white outline). k-m.
PMC7790857	figure	Extended Data Figure 4:	10	Acj6	FBbt:00004914	female accessory gland	AcGl,FBbt:00004914,appendicular gland,colleterial gland,parovarium	1.0	All LC12 cells bodies are cut+, Acj6+ and toy+.
PMC7790857	figure	Extended Data Figure 4:	11	adult optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	1.0	Red line delineates LC12 cell body location. n, Expression pattern of LC17-Gal4 (green) in the adult optic lobe (n=5 brains) with anti-NCad immunostaining (magenta) showing processes in lobula layers 2–5.
PMC7790857	figure	Extended Data Figure 4:	12	LC17	FBbt:00111752	lobula columnar neuron LC17	LC17,FBbt:00111752	1.0	LC17 project to the PVLP optic glomerulus (white outline) adjacent to that of LC12 (asterisk, see also i). o, Expression pattern of Kn-Gal4 (green) in the adult optic lobe (n=3 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC17 in the PVLP (white outline).
PMC7790857	figure	Extended Data Figure 4:	12	PVLP optic glomerulus	FBbt:00003698	optic glomerulus	optic focus,FBbt:00003698	0.8708845376968384	LC17 project to the PVLP optic glomerulus (white outline) adjacent to that of LC12 (asterisk, see also i). o, Expression pattern of Kn-Gal4 (green) in the adult optic lobe (n=3 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC17 in the PVLP (white outline).
PMC7790857	figure	Extended Data Figure 4:	12	LC12	FBbt:00100484	lobula columnar neuron LC12	LC12,FBbt:00100484,Lcn12	0.9999998807907104	LC17 project to the PVLP optic glomerulus (white outline) adjacent to that of LC12 (asterisk, see also i). o, Expression pattern of Kn-Gal4 (green) in the adult optic lobe (n=3 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC17 in the PVLP (white outline).
PMC7790857	figure	Extended Data Figure 4:	12	adult optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	1.0	LC17 project to the PVLP optic glomerulus (white outline) adjacent to that of LC12 (asterisk, see also i). o, Expression pattern of Kn-Gal4 (green) in the adult optic lobe (n=3 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC17 in the PVLP (white outline).
PMC7790857	figure	Extended Data Figure 4:	12	optic glomerulus	FBbt:00003698	optic glomerulus	optic focus,FBbt:00003698	1.0	LC17 project to the PVLP optic glomerulus (white outline) adjacent to that of LC12 (asterisk, see also i). o, Expression pattern of Kn-Gal4 (green) in the adult optic lobe (n=3 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC17 in the PVLP (white outline).
PMC7790857	figure	Extended Data Figure 4:	12	PVLP	FBbt:00040042	posterior ventrolateral protocerebrum	PVLP,FBbt:00040042,posterior VLP	1.0	LC17 project to the PVLP optic glomerulus (white outline) adjacent to that of LC12 (asterisk, see also i). o, Expression pattern of Kn-Gal4 (green) in the adult optic lobe (n=3 brains) with anti-NCad immunostaining (magenta) showing a strong expression profile in the optic glomerulus corresponding to LC17 in the PVLP (white outline).
PMC7790857	figure	Extended Data Figure 4:	14	Acj6	FBbt:00004914	female accessory gland	AcGl,FBbt:00004914,appendicular gland,colleterial gland,parovarium	1.0	All LC17 cells bodies are Acj6+ and toy+.
PMC7790857	figure	Extended Data Figure 4:	15	LC17	FBbt:00111752	lobula columnar neuron LC17	LC17,FBbt:00111752	1.0	Red line delineates LC17 cell body location (p-q).
PMC7790857	figure	Extended Data Figure 4:	16	Me	FBbt:00003748	medulla	ME,FBbt:00003748,Med,m,optic medulla	1.0	Me, medulla; Lo, lobula; LoP, lobula plate.
PMC7790857	figure	Extended Data Figure 4:	16	medulla	FBbt:00003748	medulla	ME,FBbt:00003748,Med,m,optic medulla	1.0	Me, medulla; Lo, lobula; LoP, lobula plate.
PMC7790857	figure	Extended Data Figure 4:	16	Lo	FBbt:00000533	mesothoracic lateral oblique muscle cell	LO,FBbt:00000533	1.0	Me, medulla; Lo, lobula; LoP, lobula plate.
PMC7790857	figure	Extended Data Figure 4:	16	lobula	FBbt:00003852	lobula	LO,FBbt:00003852,Lo,Lob	1.0	Me, medulla; Lo, lobula; LoP, lobula plate.
PMC7790857	figure	Extended Data Figure 4:	16	LoP	FBbt:00003885	lobula plate	LOP,FBbt:00003885,LoP,Lop,lobula plate neuropil	1.0	Me, medulla; Lo, lobula; LoP, lobula plate.
PMC7790857	figure	Extended Data Figure 4:	16	lobula plate	FBbt:00003885	lobula plate	LOP,FBbt:00003885,LoP,Lop,lobula plate neuropil	1.0	Me, medulla; Lo, lobula; LoP, lobula plate.
PMC7790857	figure	Extended Data Figure 5:	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Overview of the final adult clusters. a, Hierarchical clustering tree of our adult clusters, based on the average log-normalized non-integrated expression of the 2,000 most variable genes of the dataset (the genes used to define the unsupervised clusters, Methods).
PMC7790857	figure	Extended Data Figure 5:	3	photoreceptors	FBbt:00004211	photoreceptor neuron	photoreceptor cell,FBbt:00004211,receptor cell	0.9045262336730957	Importantly, photoreceptors (PR) and lamina neurons L1-L5 clusters contain fewer cells, as these neuronal types were not included in equal proportions in all libraries.
PMC7790857	figure	Extended Data Figure 5:	3	PR	FBbt:00003627	protocerebrum	PR,FBbt:00003627,protocerebral neuromere	1.0	Importantly, photoreceptors (PR) and lamina neurons L1-L5 clusters contain fewer cells, as these neuronal types were not included in equal proportions in all libraries.
PMC7790857	figure	Extended Data Figure 5:	4	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	As the number of cells per optic lobe for a given neuronal type is rarely formally counted, unicolumnar vs. multicolumnar character is based both on general knowledge and the following references7,8,12,54.
PMC7790857	figure	Extended Data Figure 6:	2	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Cells colors indicate the clusters they belonged to according to unsupervised clustering (a), or the adult clusters they were classified as by the neural network (b, same as in Fig.1e).
PMC7790857	figure	Extended Data Figure 6:	3	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Black circles indicate high granularity regions, where less frequent cell types were grouped together by unsupervised clustering but could be resolved accurately by the neural network (b). c, Same as in (a-b) but cells are named and colored by the adult cluster they were classified as by Seurat label transfer (Methods). d, tSNE visualizations (same as c) including only the cells that were assigned inconsistent identities by Seurat and the neural network.
PMC7790857	figure	Extended Data Figure 6:	3	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Black circles indicate high granularity regions, where less frequent cell types were grouped together by unsupervised clustering but could be resolved accurately by the neural network (b). c, Same as in (a-b) but cells are named and colored by the adult cluster they were classified as by Seurat label transfer (Methods). d, tSNE visualizations (same as c) including only the cells that were assigned inconsistent identities by Seurat and the neural network.
PMC7790857	figure	Extended Data Figure 6:	4	L1	FBbt:00003719	lamina monopolar neuron L1	L1,FBbt:00003719,monopolar laminar cell L1	0.9999999403953552	Highest rates of inconsistencies were observed in the center (LQ cells), in L1 and L2 clusters (red ellipses), in most glia clusters (green ellipses), the TE neurons and a glia-like cluster (identity 214, Suppl.
PMC7790857	figure	Extended Data Figure 6:	4	glia	FBbt:00100497	adult glial cell	glia,FBbt:00100497	1.0	Highest rates of inconsistencies were observed in the center (LQ cells), in L1 and L2 clusters (red ellipses), in most glia clusters (green ellipses), the TE neurons and a glia-like cluster (identity 214, Suppl.
PMC7790857	figure	Extended Data Figure 6:	4	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Highest rates of inconsistencies were observed in the center (LQ cells), in L1 and L2 clusters (red ellipses), in most glia clusters (green ellipses), the TE neurons and a glia-like cluster (identity 214, Suppl.
PMC7790857	figure	Extended Data Figure 6:	5	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Table 1) with no adult correspondence (blue ellipses). e-f, tSNE visualizations of 56,902 cells sequenced from whole fly brains19, using 120 principal components calculated on the log-normalized gene expression. e, Cells are named and colored by the clusters they were classified as by our neural network. f, Cells are named by the cluster identities from the original study and colored by the confidence score they received from our neural network.
PMC7790857	figure	Extended Data Figure 6:	6	right	FBbt:00051240	right asymmetrical body	AB(R),FBbt:00051240,right AB	0.8630387187004089	Black circles mark the following central brain clusters (from left to right): Poxn, OPN, clock neurons and dopaminergic neurons, that all received low scores from the neural network.
PMC7790857	figure	Extended Data Figure 6:	6	Poxn	FBbt:00004506	lateral ocellus	pOC,FBbt:00004506,posterior ocellus	1.0	Black circles mark the following central brain clusters (from left to right): Poxn, OPN, clock neurons and dopaminergic neurons, that all received low scores from the neural network.
PMC7790857	figure	Extended Data Figure 6:	6	clock	FBbt:00006048	pacemaker neuron	clock neuron,FBbt:00006048	0.9477792978286743	Black circles mark the following central brain clusters (from left to right): Poxn, OPN, clock neurons and dopaminergic neurons, that all received low scores from the neural network.
PMC7790857	figure	Extended Data Figure 6:	7	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Kenyon cells (red circles) were assigned with high confidence as our adult dataset was contaminated by them (cluster 112).
PMC7790857	figure	Extended Data Figure 6:	7	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	Kenyon cells (red circles) were assigned with high confidence as our adult dataset was contaminated by them (cluster 112).
PMC7790857	figure	Extended Data Figure 7:	1	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	High resolution transcriptomic atlases of the optic lobe across development. tSNE visualizations of all optic lobe single-cell transcriptomes acquired for this study, using 120 principal components calculated on the log-normalized integrated gene expression.
PMC7790857	figure	Extended Data Figure 7:	3	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	Blue ellipses: Dm3 and Tm9 neuronal subtypes, which could only be resolved at P50 and earlier.
PMC7790857	figure	Extended Data Figure 7:	3	Tm9	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Blue ellipses: Dm3 and Tm9 neuronal subtypes, which could only be resolved at P50 and earlier.
PMC7790857	figure	Extended Data Figure 8:	2	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Cells are named by the unsupervised cluster they were assigned to and colored by (a) the confidence score they received from the neural network (NN) or by (b) the log-normalized non-integrated expression of Fs (green), dimm (blue), and skl (red), which are co-expressed in TE neurons (red ellipses). c, Violin plot of log-normalized non-integrated prt expression in all clusters at P50.
PMC7790857	figure	Extended Data Figure 8:	3	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	TE neuron clusters are indicated by circle. d, R10D10-Gal4 co-expression with anti-Prt staining in a P50 optic lobe (n=15 neurons).
PMC7790857	figure	Extended Data Figure 8:	3	neuron	FBbt:00001564	U neuron	U motor neuron,FBbt:00001564,U/CQ neuron	1.0	TE neuron clusters are indicated by circle. d, R10D10-Gal4 co-expression with anti-Prt staining in a P50 optic lobe (n=15 neurons).
PMC7790857	figure	Extended Data Figure 8:	4	adult optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	1.0	Scale bar: 10 μm. e, FLEXAMP memory cassette labeling of R10D10-Gal4 in an adult optic lobe (n=28 brains) with anti-NCad staining.
PMC7790857	figure	Extended Data Figure 8:	8	Medulla	FBbt:00003748	medulla	ME,FBbt:00003748,Med,m,optic medulla	1.0	Scale bars = 5 μm (g) and 15 μm (h). d/pMe: distal/proximal Medulla, Lo: Lobula, Lp: Lobula plate.
PMC7790857	figure	Extended Data Figure 8:	8	Lp	FBbt:00000402	lateroposterior tracheal branch	LP,FBbt:00000402	1.0	Scale bars = 5 μm (g) and 15 μm (h). d/pMe: distal/proximal Medulla, Lo: Lobula, Lp: Lobula plate.
PMC7790857	figure	Extended Data Figure 8:	8	Lobula plate	FBbt:00003885	lobula plate	LOP,FBbt:00003885,LoP,Lop,lobula plate neuropil	1.0	Scale bars = 5 μm (g) and 15 μm (h). d/pMe: distal/proximal Medulla, Lo: Lobula, Lp: Lobula plate.
PMC7790857	figure	Extended Data Figure 8:	10	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Dashed ellipses: TE neurons.
PMC7790857	figure	Extended Data Figure 9:	1	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	Early differentiation and transcriptomic synchronization of optic lobe neurons and summary of the main findings. a-b, tSNE visualization of the P15 optic lobe single-cell transcriptomes, using 120 principal components calculated on the log-normalized integrated gene expression.
PMC7790857	figure	Extended Data Figure 9:	4	Tm3	FBbt:00003791	transmedullary neuron Tm3a	Tm3,FBbt:00003791,Tm3a,transmedullary neuron Tm3	1.0	Cells are colored by the log-normalized non-integrated expression of nerfin-1 (green), Hey (blue), and vfl (red) d, UMAP visualization of Tm3 and T1 cells (above and below the dashed line, respectively) from all stages sequenced in this study, using 25 principal components calculated on the log-normalized non-integrated gene expression.
PMC7790857	figure	Extended Data Figure 9:	6	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Moreover, TE and at least 3 other neuronal types express Wnt4 in the ventral medulla/lobula but express Wnt10 in the dorsal part of these neuropils. f, The transcriptome of neurons from the same neuronal type but produced days apart converge towards a similar transcriptomic state, which they reach by P30.
PMC7790857	figure	Extended Data Figure 9:	6	Wnt4	FBbt:00003160	adult heart chamber 4	Ht4,FBbt:00003160,chamber 4,terminal cardiac chamber	1.0	Moreover, TE and at least 3 other neuronal types express Wnt4 in the ventral medulla/lobula but express Wnt10 in the dorsal part of these neuropils. f, The transcriptome of neurons from the same neuronal type but produced days apart converge towards a similar transcriptomic state, which they reach by P30.
PMC7790857	figure	Extended Data Figure 10:	1	logFC	FBbt:00000533	mesothoracic lateral oblique muscle cell	LO,FBbt:00000533	1.0	Increased transcriptomic diversity during synaptogenesis. a, Log-normalized and scaled (to the max of 1 for each gene across all time points) expression of top10 (by logFC, calculated at P50) subcluster markers between T4 and T5 subtypes at all stages.
PMC7790857	figure	Extended Data Figure 10:	1	T4	FBbt:00003731	T neuron T4	T4,FBbt:00003731	1.0	Increased transcriptomic diversity during synaptogenesis. a, Log-normalized and scaled (to the max of 1 for each gene across all time points) expression of top10 (by logFC, calculated at P50) subcluster markers between T4 and T5 subtypes at all stages.
PMC7790857	figure	Extended Data Figure 10:	1	T5	FBbt:00003736	T neuron T5	T5,FBbt:00003736	1.0	Increased transcriptomic diversity during synaptogenesis. a, Log-normalized and scaled (to the max of 1 for each gene across all time points) expression of top10 (by logFC, calculated at P50) subcluster markers between T4 and T5 subtypes at all stages.
PMC7790857	figure	Extended Data Figure 10:	4	plots	FBbt:00007083	adult posterior lateral fascicle	PLF,FBbt:00007083,p l fasc	1.0	Inner rings in the CirGO plots indicate the summarized terms (names in bold).
PMC7790857	figure	Extended Data Figure 10:	6	Dm3	FBbt:00003770	distal medullary amacrine neuron Dm3	Dm3,FBbt:00003770	1.0	Areas within the graphs are determined by the p-values of the terms. d, Average normalized number of presynaptic sites from Dm3 neurons with orthogonally oriented dendritic arbors (Since we could not assign the anatomical directions from the EM data, we plotted them as Dm3x and Dm3y) to indicated neuronal types (Methods).
PMC7790857	figure	Extended Data Figure 10:	6	dendritic arbors	FBbt:00005111	dendritic tree	dendritic arbor,FBbt:00005111	0.9352812170982361	Areas within the graphs are determined by the p-values of the terms. d, Average normalized number of presynaptic sites from Dm3 neurons with orthogonally oriented dendritic arbors (Since we could not assign the anatomical directions from the EM data, we plotted them as Dm3x and Dm3y) to indicated neuronal types (Methods).
PMC7790857	figure	Extended Data Figure 10:	8	Tm28	FBbt:00003816	transmedullary neuron Tm28	Tm28,FBbt:00003816	1.0	Error bars denote SEM. p-value: 0.004 (Dm3x), 0.006 (Dm3y), 0.04 (Tm28), unpaired parametric two-tailed t-tests (n = 5 and 7 Dm3 cells per type). e, Number of genes differentially expressed between the indicated subtypes with a p-value < 0.01 (two-sided Wilcoxon Rank Sum), calculated after down-sampling the number of cells in each group to 150 for consistency.
PMC7790857	figure	Extended Data Figure 11:	1	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	GO enrichment analysis of the cluster and stage markers.
PMC7790857	figure	Extended Data Figure 11:	2	logFC	FBbt:00000533	mesothoracic lateral oblique muscle cell	LO,FBbt:00000533	1.0	GO terms were determined from a, the most differentially expressed genes between neuronal clusters (ranked top20 by logFC for at least one cluster) at all stages separately or b, all genes differentially expressed between stages (Methods) in all neurons (aggregated)..
PMC7790857	figure	Extended Data Figure 11:	2	cluster	FBbt:00001617	deutero/tritocerebral embryonic fiber tract founder cluster	D/T cluster,FBbt:00001617	1.0	GO terms were determined from a, the most differentially expressed genes between neuronal clusters (ranked top20 by logFC for at least one cluster) at all stages separately or b, all genes differentially expressed between stages (Methods) in all neurons (aggregated)..
PMC7790857	figure	Extended Data Figure 12	1	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Dorsal and ventral visual circuits are partitioned by differential Wnt signaling. a,Tm9-Gal4 sparse labeling in the ventral and dorsal part of the same adult optic lobe (n=4 neurons) with anti-NCad immunostaining (gray). b, Expression pattern of Wnt4-Gal4 (green) with anti-Chaoptin immunostaining (magenta) in the adult optic lobe (n=8 brains). c, Expression pattern of Wnt4-Gal4 (green) with anti-Chaoptin (magenta) and anti-Dve (cyan) immunostainings, in the ventral retina at P30 (n=6 eye discs).
PMC7790857	figure	Extended Data Figure 12	1	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	Dorsal and ventral visual circuits are partitioned by differential Wnt signaling. a,Tm9-Gal4 sparse labeling in the ventral and dorsal part of the same adult optic lobe (n=4 neurons) with anti-NCad immunostaining (gray). b, Expression pattern of Wnt4-Gal4 (green) with anti-Chaoptin immunostaining (magenta) in the adult optic lobe (n=8 brains). c, Expression pattern of Wnt4-Gal4 (green) with anti-Chaoptin (magenta) and anti-Dve (cyan) immunostainings, in the ventral retina at P30 (n=6 eye discs).
PMC7790857	figure	Extended Data Figure 12	1	adult optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	1.0	Dorsal and ventral visual circuits are partitioned by differential Wnt signaling. a,Tm9-Gal4 sparse labeling in the ventral and dorsal part of the same adult optic lobe (n=4 neurons) with anti-NCad immunostaining (gray). b, Expression pattern of Wnt4-Gal4 (green) with anti-Chaoptin immunostaining (magenta) in the adult optic lobe (n=8 brains). c, Expression pattern of Wnt4-Gal4 (green) with anti-Chaoptin (magenta) and anti-Dve (cyan) immunostainings, in the ventral retina at P30 (n=6 eye discs).
PMC7790857	figure	Extended Data Figure 12	2	photoreceptors	FBbt:00004211	photoreceptor neuron	photoreceptor cell,FBbt:00004211,receptor cell	0.9045262336730957	Chaoptin marks all photoreceptors, and Dve is expressed in the photoreceptors R1–6 and a subset of R7 (yellow R7), but not in R8 and the rest of R755. d, Expression pattern of Tm4-Gal4 (green) with anti-Aop immunostaining (magenta) at P50 (n=3 brains), showing that almost all Aop+ neurons are co-labelled by Tm4-Gal4.
PMC7790857	figure	Extended Data Figure 12	2	R8	FBbt:00004227	photoreceptor cell R8	R8,FBbt:00004227,lamina receptor cell R8,receptor cell R8	1.0	Chaoptin marks all photoreceptors, and Dve is expressed in the photoreceptors R1–6 and a subset of R7 (yellow R7), but not in R8 and the rest of R755. d, Expression pattern of Tm4-Gal4 (green) with anti-Aop immunostaining (magenta) at P50 (n=3 brains), showing that almost all Aop+ neurons are co-labelled by Tm4-Gal4.
PMC7790857	figure	Extended Data Figure 12	4	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	Aop+ neurons co-express Wnt4-Gal4 in the ventral (white arrows) but not dorsal (white arrowheads) optic lobe. f, fz2, mamo or CG9896 differential expression between either Tm9v and Tm9d cells, TEv and TEd cells, Wnt4+/Wnt10- and Wnt4-/Wnt10+ Tm4 cells or Wnt4+/Wnt10- and Wnt4-/Wnt10+ cluster 62 cells (log-normalized non-integrated expression).
PMC7790857	figure	Extended Data Figure 12	4	mamo	FBbt:00110191	lower toe of larval mushroom body medial lobe	MAML,FBbt:00110191,MB-MA,axonal side branches,bulbous swelling,lower toe,ma,medial appendix of larval mushroom body	1.0	Aop+ neurons co-express Wnt4-Gal4 in the ventral (white arrows) but not dorsal (white arrowheads) optic lobe. f, fz2, mamo or CG9896 differential expression between either Tm9v and Tm9d cells, TEv and TEd cells, Wnt4+/Wnt10- and Wnt4-/Wnt10+ Tm4 cells or Wnt4+/Wnt10- and Wnt4-/Wnt10+ cluster 62 cells (log-normalized non-integrated expression).
PMC7790857	figure	Extended Data Figure 12	4	Tm9v	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Aop+ neurons co-express Wnt4-Gal4 in the ventral (white arrows) but not dorsal (white arrowheads) optic lobe. f, fz2, mamo or CG9896 differential expression between either Tm9v and Tm9d cells, TEv and TEd cells, Wnt4+/Wnt10- and Wnt4-/Wnt10+ Tm4 cells or Wnt4+/Wnt10- and Wnt4-/Wnt10+ cluster 62 cells (log-normalized non-integrated expression).
PMC7790857	figure	Extended Data Figure 12	4	TEv	FBbt:00058014	ventral transient extrinsic neuron of pupal optic lobe	TEv,FBbt:00058014,TEv neuron	1.0	Aop+ neurons co-express Wnt4-Gal4 in the ventral (white arrows) but not dorsal (white arrowheads) optic lobe. f, fz2, mamo or CG9896 differential expression between either Tm9v and Tm9d cells, TEv and TEd cells, Wnt4+/Wnt10- and Wnt4-/Wnt10+ Tm4 cells or Wnt4+/Wnt10- and Wnt4-/Wnt10+ cluster 62 cells (log-normalized non-integrated expression).
PMC7790857	figure	Extended Data Figure 12	4	TEd	FBbt:00058015	dorsal transient extrinsic neuron of pupal optic lobe	TEd,FBbt:00058015,TEd neuron	1.0	Aop+ neurons co-express Wnt4-Gal4 in the ventral (white arrows) but not dorsal (white arrowheads) optic lobe. f, fz2, mamo or CG9896 differential expression between either Tm9v and Tm9d cells, TEv and TEd cells, Wnt4+/Wnt10- and Wnt4-/Wnt10+ Tm4 cells or Wnt4+/Wnt10- and Wnt4-/Wnt10+ cluster 62 cells (log-normalized non-integrated expression).
PMC7790857	figure	Figure 1:	1	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	High resolution transcriptomic atlases of the optic lobe across development. a, Optic lobe cross-section3, with drawings of unicolumnar (orange shades) and multicolumnar (blue) neurons.
PMC7790857	figure	Figure 1:	3	lateral	FBbt:00004044	LN period neuron	LC,FBbt:00004044,LN,LN per neuron,adult lateral neuron,lateral cell,lateral neuron	0.8629997968673706	A: anterior, L: lateral, M: medial, P: posterior. b, Approach followed to produce the adult dataset. c, Pearson correlation between the average gene expression of the adult dataset clusters (x-axis) and the transcriptome of isolated Lawf1 neurons (Methods). d, tSNE visualization of the final adult dataset, using 120 principal components calculated on the log-normalized integrated gene expression.
PMC7790857	figure	Figure 1:	3	M	FBbt:00003597	obsolete abdominal 2 neuroblast medial cluster	m,FBbt:00003597	1.0	A: anterior, L: lateral, M: medial, P: posterior. b, Approach followed to produce the adult dataset. c, Pearson correlation between the average gene expression of the adult dataset clusters (x-axis) and the transcriptome of isolated Lawf1 neurons (Methods). d, tSNE visualization of the final adult dataset, using 120 principal components calculated on the log-normalized integrated gene expression.
PMC7790857	figure	Figure 1:	3	posterior	FBbt:00040046	posterior superior lateral protocerebrum	PSLP,FBbt:00040046,posterior SLP,posterior splr,pslpr	0.8775382041931152	A: anterior, L: lateral, M: medial, P: posterior. b, Approach followed to produce the adult dataset. c, Pearson correlation between the average gene expression of the adult dataset clusters (x-axis) and the transcriptome of isolated Lawf1 neurons (Methods). d, tSNE visualization of the final adult dataset, using 120 principal components calculated on the log-normalized integrated gene expression.
PMC7790857	figure	Figure 1:	3	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	A: anterior, L: lateral, M: medial, P: posterior. b, Approach followed to produce the adult dataset. c, Pearson correlation between the average gene expression of the adult dataset clusters (x-axis) and the transcriptome of isolated Lawf1 neurons (Methods). d, tSNE visualization of the final adult dataset, using 120 principal components calculated on the log-normalized integrated gene expression.
PMC7790857	figure	Figure 1:	3	Lawf1	FBbt:00003741	lamina wide-field 1 neuron	LaWF1,FBbt:00003741,Lawf,Lawf1	1.0	A: anterior, L: lateral, M: medial, P: posterior. b, Approach followed to produce the adult dataset. c, Pearson correlation between the average gene expression of the adult dataset clusters (x-axis) and the transcriptome of isolated Lawf1 neurons (Methods). d, tSNE visualization of the final adult dataset, using 120 principal components calculated on the log-normalized integrated gene expression.
PMC7790857	figure	Figure 1:	5	pupal	FBbt:00002957	pupal tracheal dorsal trunk	pupal DT,FBbt:00002957,pupal dorsal longitudinal trunk,pupal great lateral trunk	0.8800613284111023	Table 1). e, Approximate time frames of different steps of optic lobe development, and tSNE visualizations of the pupal datasets.
PMC7790857	figure	Figure 1:	6	adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Colors match to the adult dataset as classified by the neural network. f, Multi-task neural network classifier used at each stage to sequentially match developing cells to the adult clusters, as detailed in Methods.
PMC7790857	figure	Figure 2:	1	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Transient Extrinsic neurons demarcate the optic lobe neuropils and undergo apoptosis during late pupal development. a, UMAP visualization of TE neurons, using 10 principal components calculated on the log-normalized integrated gene expression, across development. b, R10D10-Gal4 expression pattern (max projection) at the indicated stages (n=10 brains per stage), anterior view (with overexpression of anti-apoptotic protein p35 only in the last panel).
PMC7790857	figure	Figure 2:	4	La	FBbt:00003708	lamina	LA,FBbt:00003708,La	1.0	La = Lamina, Lo = Lobula, Me = Medulla, Lp = Lobula plate. c-d, Fs-Gal4 expression pattern (3D reconstruction) in P30 optic lobes (n=4 brains) with anti-NCad staining. d/pMe = distal/proximal Medulla. e, R10D10-LexA and Wnt4-Gal4 co-expression (white) pattern in a P50 optic lobe (max projection), with anti-NCad staining (n=8 brains).
PMC7790857	figure	Figure 2:	4	Lamina	FBbt:00003708	lamina	LA,FBbt:00003708,La	1.0	La = Lamina, Lo = Lobula, Me = Medulla, Lp = Lobula plate. c-d, Fs-Gal4 expression pattern (3D reconstruction) in P30 optic lobes (n=4 brains) with anti-NCad staining. d/pMe = distal/proximal Medulla. e, R10D10-LexA and Wnt4-Gal4 co-expression (white) pattern in a P50 optic lobe (max projection), with anti-NCad staining (n=8 brains).
PMC7790857	figure	Figure 2:	4	Me	FBbt:00003748	medulla	ME,FBbt:00003748,Med,m,optic medulla	1.0	La = Lamina, Lo = Lobula, Me = Medulla, Lp = Lobula plate. c-d, Fs-Gal4 expression pattern (3D reconstruction) in P30 optic lobes (n=4 brains) with anti-NCad staining. d/pMe = distal/proximal Medulla. e, R10D10-LexA and Wnt4-Gal4 co-expression (white) pattern in a P50 optic lobe (max projection), with anti-NCad staining (n=8 brains).
PMC7790857	figure	Figure 2:	4	Medulla	FBbt:00003748	medulla	ME,FBbt:00003748,Med,m,optic medulla	1.0	La = Lamina, Lo = Lobula, Me = Medulla, Lp = Lobula plate. c-d, Fs-Gal4 expression pattern (3D reconstruction) in P30 optic lobes (n=4 brains) with anti-NCad staining. d/pMe = distal/proximal Medulla. e, R10D10-LexA and Wnt4-Gal4 co-expression (white) pattern in a P50 optic lobe (max projection), with anti-NCad staining (n=8 brains).
PMC7790857	figure	Figure 2:	4	Lp	FBbt:00000402	lateroposterior tracheal branch	LP,FBbt:00000402	1.0	La = Lamina, Lo = Lobula, Me = Medulla, Lp = Lobula plate. c-d, Fs-Gal4 expression pattern (3D reconstruction) in P30 optic lobes (n=4 brains) with anti-NCad staining. d/pMe = distal/proximal Medulla. e, R10D10-LexA and Wnt4-Gal4 co-expression (white) pattern in a P50 optic lobe (max projection), with anti-NCad staining (n=8 brains).
PMC7790857	figure	Figure 2:	4	Lobula plate	FBbt:00003885	lobula plate	LOP,FBbt:00003885,LoP,Lop,lobula plate neuropil	1.0	La = Lamina, Lo = Lobula, Me = Medulla, Lp = Lobula plate. c-d, Fs-Gal4 expression pattern (3D reconstruction) in P30 optic lobes (n=4 brains) with anti-NCad staining. d/pMe = distal/proximal Medulla. e, R10D10-LexA and Wnt4-Gal4 co-expression (white) pattern in a P50 optic lobe (max projection), with anti-NCad staining (n=8 brains).
PMC7790857	figure	Figure 2:	5	TE	FBbt:00058013	transient extrinsic neuron of pupal optic lobe	TE,FBbt:00058013,TE neuron	1.0	Dashed ellipses: TE neurons.
PMC7790857	figure	Figure 3:	2	undifferentiated	FBbt:00049609	undifferentiated glial cell	developing glial cell,FBbt:00049609,udg	0.8597781658172607	Ellipses: undifferentiated neurons undergoing apoptosis (red), stem cells (green), intermediate precursors (blue). b-e, UMAP visualization of the Tm3 cluster at P15 and P30.
PMC7790857	figure	Figure 4:	1	T4	FBbt:00003731	T neuron T4	T4,FBbt:00003731	1.0	Increased transcriptomic diversity during synaptogenesis. a, tSNE visualizations of T4 and T5 neurons, using 20 principal components calculated on the log-normalized integrated gene expression, across development. b, R25F07(Dm3)-Gal4 sparse expression at P50 with anti-Bi (Omb) staining (n=10 brains).
PMC7790857	figure	Figure 4:	1	T5	FBbt:00003736	T neuron T5	T5,FBbt:00003736	1.0	Increased transcriptomic diversity during synaptogenesis. a, tSNE visualizations of T4 and T5 neurons, using 20 principal components calculated on the log-normalized integrated gene expression, across development. b, R25F07(Dm3)-Gal4 sparse expression at P50 with anti-Bi (Omb) staining (n=10 brains).
PMC7790857	figure	Figure 5:	1	optic lobe	FBbt:00003701	adult optic lobe	OL,FBbt:00003701	0.9481093883514404	Dorsal and ventral visual circuits are partitioned by differential Wnt signaling. a, Pattern of Wnt4-Gal4 and Tm9-LexA co-expression (white) at P50 in the ventral and dorsal part of the same optic lobe (n=8 brains).
PMC7790857	figure	Figure 5:	2	photoreceptors	FBbt:00004211	photoreceptor neuron	photoreceptor cell,FBbt:00004211,receptor cell	0.9045262336730957	Red dashed line: location of photoreceptors. b, Wnt4-Gal4 expression pattern with anti-Chaoptin staining to mark photoreceptors in a P30 retina (n=6 eye discs).
PMC7790857	figure	Figure 5:	2	mark photoreceptors	FBbt:00004211	photoreceptor neuron	photoreceptor cell,FBbt:00004211,receptor cell	0.8532077074050903	Red dashed line: location of photoreceptors. b, Wnt4-Gal4 expression pattern with anti-Chaoptin staining to mark photoreceptors in a P30 retina (n=6 eye discs).
PMC7790857	figure	Figure 5:	4	Wnt4	FBbt:00003160	adult heart chamber 4	Ht4,FBbt:00003160,chamber 4,terminal cardiac chamber	1.0	Dashed line within inset: equator of the retina. c, tSNE of the indicated clusters throughout development, with Wnt4 and Wnt10 log-normalized non-integrated expression levels. d, 5-HT1A differential expression between either Wnt4+/Wnt10- and Wnt4-/Wnt10+ Tm4 cells, or Tm9v and Tm9d cells (Methods). ***: adjusted p-value < 0.001 (P70 Tm9: 6×10−9, Adult Tm9: 3×10−18, P50 Tm4: 1×10−9, P70 Tm4: 2×10−7, Adult Tm4: 1×10−34), ns: not significant, two-sided Wilcoxon Rank Sum test.
PMC7790857	figure	Figure 5:	4	Tm9v	FBbt:00003797	transmedullary neuron Tm9	Tm9,FBbt:00003797	1.0	Dashed line within inset: equator of the retina. c, tSNE of the indicated clusters throughout development, with Wnt4 and Wnt10 log-normalized non-integrated expression levels. d, 5-HT1A differential expression between either Wnt4+/Wnt10- and Wnt4-/Wnt10+ Tm4 cells, or Tm9v and Tm9d cells (Methods). ***: adjusted p-value < 0.001 (P70 Tm9: 6×10−9, Adult Tm9: 3×10−18, P50 Tm4: 1×10−9, P70 Tm4: 2×10−7, Adult Tm4: 1×10−34), ns: not significant, two-sided Wilcoxon Rank Sum test.
PMC7790857	figure	Figure 5:	4	P70 Tm4	FBbt:00003792	transmedullary neuron Tm4	Tm4,FBbt:00003792	0.8552038669586182	Dashed line within inset: equator of the retina. c, tSNE of the indicated clusters throughout development, with Wnt4 and Wnt10 log-normalized non-integrated expression levels. d, 5-HT1A differential expression between either Wnt4+/Wnt10- and Wnt4-/Wnt10+ Tm4 cells, or Tm9v and Tm9d cells (Methods). ***: adjusted p-value < 0.001 (P70 Tm9: 6×10−9, Adult Tm9: 3×10−18, P50 Tm4: 1×10−9, P70 Tm4: 2×10−7, Adult Tm4: 1×10−34), ns: not significant, two-sided Wilcoxon Rank Sum test.
PMC7790857	figure	Figure 5:	4	Adult	FBbt:00003004	adult	imago,FBbt:00003004	1.0	Dashed line within inset: equator of the retina. c, tSNE of the indicated clusters throughout development, with Wnt4 and Wnt10 log-normalized non-integrated expression levels. d, 5-HT1A differential expression between either Wnt4+/Wnt10- and Wnt4-/Wnt10+ Tm4 cells, or Tm9v and Tm9d cells (Methods). ***: adjusted p-value < 0.001 (P70 Tm9: 6×10−9, Adult Tm9: 3×10−18, P50 Tm4: 1×10−9, P70 Tm4: 2×10−7, Adult Tm4: 1×10−34), ns: not significant, two-sided Wilcoxon Rank Sum test.
PMC7790857	figure	Figure 5:	4	Tm4	FBbt:00003792	transmedullary neuron Tm4	Tm4,FBbt:00003792	0.9999998807907104	Dashed line within inset: equator of the retina. c, tSNE of the indicated clusters throughout development, with Wnt4 and Wnt10 log-normalized non-integrated expression levels. d, 5-HT1A differential expression between either Wnt4+/Wnt10- and Wnt4-/Wnt10+ Tm4 cells, or Tm9v and Tm9d cells (Methods). ***: adjusted p-value < 0.001 (P70 Tm9: 6×10−9, Adult Tm9: 3×10−18, P50 Tm4: 1×10−9, P70 Tm4: 2×10−7, Adult Tm4: 1×10−34), ns: not significant, two-sided Wilcoxon Rank Sum test.
